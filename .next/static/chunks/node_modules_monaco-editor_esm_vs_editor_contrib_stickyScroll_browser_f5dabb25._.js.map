{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollWidget.js","sourceRoot":"file:///mnt/vss/_work/1/s/dependencies/vscode/out-editor-src","sources":["file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/file%3A/mnt/vss/_work/1/s/dependencies/vscode/out-editor-src/vs/editor/contrib/stickyScroll/browser/stickyScrollWidget.ts","file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/vs/editor/contrib/stickyScroll/browser/stickyScrollWidget.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createTrustedTypesPolicy } from '../../../../base/browser/trustedTypes.js';\nimport { equals } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './stickyScroll.css';\nimport { ICodeEditor, IOverlayWidget, IOverlayWidgetPosition, OverlayWidgetPositionPreference } from '../../../browser/editorBrowser.js';\nimport { getColumnOfNodeOffset } from '../../../browser/viewParts/viewLines/viewLine.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { EditorLayoutInfo, EditorOption, RenderLineNumbersType } from '../../../common/config/editorOptions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { StringBuilder } from '../../../common/core/stringBuilder.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { CharacterMapping, RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { foldingCollapsedIcon, foldingExpandedIcon } from '../../folding/browser/foldingDecorations.js';\nimport { FoldingModel } from '../../folding/browser/foldingModel.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { IViewModel } from '../../../common/viewModel.js';\n\nexport class StickyScrollWidgetState {\n\tconstructor(\n\t\treadonly startLineNumbers: number[],\n\t\treadonly endLineNumbers: number[],\n\t\treadonly lastLineRelativePosition: number,\n\t\treadonly showEndForLine: number | null = null\n\t) { }\n\n\tequals(other: StickyScrollWidgetState | undefined): boolean {\n\t\treturn !!other\n\t\t\t&& this.lastLineRelativePosition === other.lastLineRelativePosition\n\t\t\t&& this.showEndForLine === other.showEndForLine\n\t\t\t&& equals(this.startLineNumbers, other.startLineNumbers)\n\t\t\t&& equals(this.endLineNumbers, other.endLineNumbers);\n\t}\n\n\tstatic get Empty() {\n\t\treturn new StickyScrollWidgetState([], [], 0);\n\t}\n}\n\nconst _ttPolicy = createTrustedTypesPolicy('stickyScrollViewLayer', { createHTML: value => value });\nconst STICKY_INDEX_ATTR = 'data-sticky-line-index';\nconst STICKY_IS_LINE_ATTR = 'data-sticky-is-line';\nconst STICKY_IS_LINE_NUMBER_ATTR = 'data-sticky-is-line-number';\nconst STICKY_IS_FOLDING_ICON_ATTR = 'data-sticky-is-folding-icon';\n\nexport class StickyScrollWidget extends Disposable implements IOverlayWidget {\n\n\tprivate readonly _foldingIconStore = new DisposableStore();\n\tprivate readonly _rootDomNode: HTMLElement = document.createElement('div');\n\tprivate readonly _lineNumbersDomNode: HTMLElement = document.createElement('div');\n\tprivate readonly _linesDomNodeScrollable: HTMLElement = document.createElement('div');\n\tprivate readonly _linesDomNode: HTMLElement = document.createElement('div');\n\n\tprivate readonly _editor: ICodeEditor;\n\n\tprivate _state: StickyScrollWidgetState | undefined;\n\tprivate _lineHeight: number;\n\tprivate _renderedStickyLines: RenderedStickyLine[] = [];\n\tprivate _lineNumbers: number[] = [];\n\tprivate _lastLineRelativePosition: number = 0;\n\tprivate _minContentWidthInPx: number = 0;\n\tprivate _isOnGlyphMargin: boolean = false;\n\tprivate _height: number = -1;\n\n\tpublic get height(): number { return this._height; }\n\n\tprivate readonly _onDidChangeStickyScrollHeight = this._register(new Emitter<{ height: number }>());\n\tpublic readonly onDidChangeStickyScrollHeight = this._onDidChangeStickyScrollHeight.event;\n\n\tconstructor(\n\t\teditor: ICodeEditor\n\t) {\n\t\tsuper();\n\n\t\tthis._editor = editor;\n\t\tthis._lineHeight = editor.getOption(EditorOption.lineHeight);\n\t\tthis._lineNumbersDomNode.className = 'sticky-widget-line-numbers';\n\t\tthis._lineNumbersDomNode.setAttribute('role', 'none');\n\n\t\tthis._linesDomNode.className = 'sticky-widget-lines';\n\t\tthis._linesDomNode.setAttribute('role', 'list');\n\n\t\tthis._linesDomNodeScrollable.className = 'sticky-widget-lines-scrollable';\n\t\tthis._linesDomNodeScrollable.appendChild(this._linesDomNode);\n\n\t\tthis._rootDomNode.className = 'sticky-widget';\n\t\tthis._rootDomNode.classList.toggle('peek', editor instanceof EmbeddedCodeEditorWidget);\n\t\tthis._rootDomNode.appendChild(this._lineNumbersDomNode);\n\t\tthis._rootDomNode.appendChild(this._linesDomNodeScrollable);\n\t\tthis._setHeight(0);\n\n\t\tconst updateScrollLeftPosition = () => {\n\t\t\tthis._linesDomNode.style.left = this._editor.getOption(EditorOption.stickyScroll).scrollWithEditor ? `-${this._editor.getScrollLeft()}px` : '0px';\n\t\t};\n\t\tthis._register(this._editor.onDidChangeConfiguration((e) => {\n\t\t\tif (e.hasChanged(EditorOption.stickyScroll)) {\n\t\t\t\tupdateScrollLeftPosition();\n\t\t\t}\n\t\t\tif (e.hasChanged(EditorOption.lineHeight)) {\n\t\t\t\tthis._lineHeight = this._editor.getOption(EditorOption.lineHeight);\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._editor.onDidScrollChange((e) => {\n\t\t\tif (e.scrollLeftChanged) {\n\t\t\t\tupdateScrollLeftPosition();\n\t\t\t}\n\t\t\tif (e.scrollWidthChanged) {\n\t\t\t\tthis._updateWidgetWidth();\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._editor.onDidChangeModel(() => {\n\t\t\tupdateScrollLeftPosition();\n\t\t\tthis._updateWidgetWidth();\n\t\t}));\n\t\tthis._register(this._foldingIconStore);\n\t\tupdateScrollLeftPosition();\n\n\t\tthis._register(this._editor.onDidLayoutChange((e) => {\n\t\t\tthis._updateWidgetWidth();\n\t\t}));\n\t\tthis._updateWidgetWidth();\n\t}\n\n\tget lineNumbers(): number[] {\n\t\treturn this._lineNumbers;\n\t}\n\n\tget lineNumberCount(): number {\n\t\treturn this._lineNumbers.length;\n\t}\n\n\tgetRenderedStickyLine(lineNumber: number): RenderedStickyLine | undefined {\n\t\treturn this._renderedStickyLines.find(stickyLine => stickyLine.lineNumber === lineNumber);\n\t}\n\n\tgetCurrentLines(): readonly number[] {\n\t\treturn this._lineNumbers;\n\t}\n\n\tsetState(state: StickyScrollWidgetState | undefined, foldingModel: FoldingModel | undefined, rebuildFromIndexCandidate?: number): void {\n\t\tconst currentStateAndPreviousStateUndefined = !this._state && !state;\n\t\tconst currentStateDefinedAndEqualsPreviousState = this._state && this._state.equals(state);\n\t\tif (rebuildFromIndexCandidate === undefined && (currentStateAndPreviousStateUndefined || currentStateDefinedAndEqualsPreviousState)) {\n\t\t\treturn;\n\t\t}\n\t\tconst data = this._findRenderingData(state);\n\t\tconst previousLineNumbers = this._lineNumbers;\n\t\tthis._lineNumbers = data.lineNumbers;\n\t\tthis._lastLineRelativePosition = data.lastLineRelativePosition;\n\t\tconst rebuildFromIndex = this._findIndexToRebuildFrom(previousLineNumbers, this._lineNumbers, rebuildFromIndexCandidate);\n\t\tthis._renderRootNode(this._lineNumbers, this._lastLineRelativePosition, foldingModel, rebuildFromIndex);\n\t\tthis._state = state;\n\t}\n\n\tprivate _findRenderingData(state: StickyScrollWidgetState | undefined): { lineNumbers: number[]; lastLineRelativePosition: number } {\n\t\tif (!state) {\n\t\t\treturn { lineNumbers: [], lastLineRelativePosition: 0 };\n\t\t}\n\t\tconst candidateLineNumbers = [...state.startLineNumbers];\n\t\tif (state.showEndForLine !== null) {\n\t\t\tcandidateLineNumbers[state.showEndForLine] = state.endLineNumbers[state.showEndForLine];\n\t\t}\n\t\tlet totalHeight = 0;\n\t\tfor (let i = 0; i < candidateLineNumbers.length; i++) {\n\t\t\ttotalHeight += this._editor.getLineHeightForPosition(new Position(candidateLineNumbers[i], 1));\n\t\t}\n\t\tif (totalHeight === 0) {\n\t\t\treturn { lineNumbers: [], lastLineRelativePosition: 0 };\n\t\t}\n\t\treturn { lineNumbers: candidateLineNumbers, lastLineRelativePosition: state.lastLineRelativePosition };\n\t}\n\n\tprivate _findIndexToRebuildFrom(previousLineNumbers: number[], newLineNumbers: number[], rebuildFromIndexCandidate?: number): number {\n\t\tif (newLineNumbers.length === 0) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (rebuildFromIndexCandidate !== undefined) {\n\t\t\treturn rebuildFromIndexCandidate;\n\t\t}\n\t\tconst validIndex = newLineNumbers.findIndex(startLineNumber => !previousLineNumbers.includes(startLineNumber));\n\t\treturn validIndex === -1 ? 0 : validIndex;\n\t}\n\n\tprivate _updateWidgetWidth(): void {\n\t\tconst layoutInfo = this._editor.getLayoutInfo();\n\t\tconst lineNumbersWidth = layoutInfo.contentLeft;\n\t\tthis._lineNumbersDomNode.style.width = `${lineNumbersWidth}px`;\n\t\tthis._linesDomNodeScrollable.style.setProperty('--vscode-editorStickyScroll-scrollableWidth', `${this._editor.getScrollWidth() - layoutInfo.verticalScrollbarWidth}px`);\n\t\tthis._rootDomNode.style.width = `${layoutInfo.width - layoutInfo.verticalScrollbarWidth}px`;\n\t}\n\n\tprivate _useFoldingOpacityTransition(requireTransitions: boolean) {\n\t\tthis._lineNumbersDomNode.style.setProperty('--vscode-editorStickyScroll-foldingOpacityTransition', `opacity ${requireTransitions ? 0.5 : 0}s`);\n\t}\n\n\tprivate _setFoldingIconsVisibility(allVisible: boolean) {\n\t\tfor (const line of this._renderedStickyLines) {\n\t\t\tconst foldingIcon = line.foldingIcon;\n\t\t\tif (!foldingIcon) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfoldingIcon.setVisible(allVisible ? true : foldingIcon.isCollapsed);\n\t\t}\n\t}\n\n\tprivate async _renderRootNode(lineNumbers: number[], lastLineRelativePosition: number, foldingModel: FoldingModel | undefined, rebuildFromIndex: number): Promise<void> {\n\t\tconst viewModel = this._editor._getViewModel();\n\t\tif (!viewModel) {\n\t\t\tthis._clearWidget();\n\t\t\treturn;\n\t\t}\n\t\tif (lineNumbers.length === 0) {\n\t\t\tthis._clearWidget();\n\t\t\treturn;\n\t\t}\n\t\tconst renderedStickyLines: RenderedStickyLine[] = [];\n\t\tconst lastLineNumber = lineNumbers[lineNumbers.length - 1];\n\t\tlet top: number = 0;\n\t\tfor (let i = 0; i < this._renderedStickyLines.length; i++) {\n\t\t\tif (i < rebuildFromIndex) {\n\t\t\t\tconst renderedLine = this._renderedStickyLines[i];\n\t\t\t\trenderedStickyLines.push(this._updatePosition(renderedLine, top, renderedLine.lineNumber === lastLineNumber));\n\t\t\t\ttop += renderedLine.height;\n\t\t\t} else {\n\t\t\t\tconst renderedLine = this._renderedStickyLines[i];\n\t\t\t\trenderedLine.lineNumberDomNode.remove();\n\t\t\t\trenderedLine.lineDomNode.remove();\n\t\t\t}\n\t\t}\n\t\tconst layoutInfo = this._editor.getLayoutInfo();\n\t\tfor (let i = rebuildFromIndex; i < lineNumbers.length; i++) {\n\t\t\tconst stickyLine = this._renderChildNode(viewModel, i, lineNumbers[i], top, lastLineNumber === lineNumbers[i], foldingModel, layoutInfo);\n\t\t\ttop += stickyLine.height;\n\t\t\tthis._linesDomNode.appendChild(stickyLine.lineDomNode);\n\t\t\tthis._lineNumbersDomNode.appendChild(stickyLine.lineNumberDomNode);\n\t\t\trenderedStickyLines.push(stickyLine);\n\t\t}\n\t\tif (foldingModel) {\n\t\t\tthis._setFoldingHoverListeners();\n\t\t\tthis._useFoldingOpacityTransition(!this._isOnGlyphMargin);\n\t\t}\n\t\tthis._minContentWidthInPx = Math.max(...this._renderedStickyLines.map(l => l.scrollWidth)) + layoutInfo.verticalScrollbarWidth;\n\t\tthis._renderedStickyLines = renderedStickyLines;\n\t\tthis._setHeight(top + lastLineRelativePosition);\n\t\tthis._editor.layoutOverlayWidget(this);\n\t}\n\n\tprivate _clearWidget(): void {\n\t\tfor (let i = 0; i < this._renderedStickyLines.length; i++) {\n\t\t\tconst stickyLine = this._renderedStickyLines[i];\n\t\t\tstickyLine.lineNumberDomNode.remove();\n\t\t\tstickyLine.lineDomNode.remove();\n\t\t}\n\t\tthis._setHeight(0);\n\t}\n\n\tprivate _setHeight(height: number): void {\n\t\tif (this._height === height) {\n\t\t\treturn;\n\t\t}\n\t\tthis._height = height;\n\n\t\tif (this._height === 0) {\n\t\t\tthis._rootDomNode.style.display = 'none';\n\t\t} else {\n\t\t\tthis._rootDomNode.style.display = 'block';\n\t\t\tthis._lineNumbersDomNode.style.height = `${this._height}px`;\n\t\t\tthis._linesDomNodeScrollable.style.height = `${this._height}px`;\n\t\t\tthis._rootDomNode.style.height = `${this._height}px`;\n\t\t}\n\n\t\tthis._onDidChangeStickyScrollHeight.fire({ height: this._height });\n\t}\n\n\tprivate _setFoldingHoverListeners(): void {\n\t\tconst showFoldingControls: 'mouseover' | 'always' | 'never' = this._editor.getOption(EditorOption.showFoldingControls);\n\t\tif (showFoldingControls !== 'mouseover') {\n\t\t\treturn;\n\t\t}\n\t\tthis._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_ENTER, () => {\n\t\t\tthis._isOnGlyphMargin = true;\n\t\t\tthis._setFoldingIconsVisibility(true);\n\t\t}));\n\t\tthis._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_LEAVE, () => {\n\t\t\tthis._isOnGlyphMargin = false;\n\t\t\tthis._useFoldingOpacityTransition(true);\n\t\t\tthis._setFoldingIconsVisibility(false);\n\t\t}));\n\t}\n\n\tprivate _renderChildNode(viewModel: IViewModel, index: number, line: number, top: number, isLastLine: boolean, foldingModel: FoldingModel | undefined, layoutInfo: EditorLayoutInfo): RenderedStickyLine {\n\t\tconst viewLineNumber = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(line, 1)).lineNumber;\n\t\tconst lineRenderingData = viewModel.getViewLineRenderingData(viewLineNumber);\n\t\tconst lineNumberOption = this._editor.getOption(EditorOption.lineNumbers);\n\t\tconst verticalScrollbarSize = this._editor.getOption(EditorOption.scrollbar).verticalScrollbarSize;\n\n\t\tlet actualInlineDecorations: LineDecoration[];\n\t\ttry {\n\t\t\tactualInlineDecorations = LineDecoration.filter(lineRenderingData.inlineDecorations, viewLineNumber, lineRenderingData.minColumn, lineRenderingData.maxColumn);\n\t\t} catch (err) {\n\t\t\tactualInlineDecorations = [];\n\t\t}\n\n\t\tconst lineHeight = this._editor.getLineHeightForPosition(new Position(line, 1));\n\t\tconst textDirection = viewModel.getTextDirection(line);\n\t\tconst renderLineInput: RenderLineInput = new RenderLineInput(true, true, lineRenderingData.content,\n\t\t\tlineRenderingData.continuesWithWrappedLine,\n\t\t\tlineRenderingData.isBasicASCII, lineRenderingData.containsRTL, 0,\n\t\t\tlineRenderingData.tokens, actualInlineDecorations,\n\t\t\tlineRenderingData.tabSize, lineRenderingData.startVisibleColumn,\n\t\t\t1, 1, 1, 500, 'none', true, true, null,\n\t\t\ttextDirection, verticalScrollbarSize\n\t\t);\n\n\t\tconst sb = new StringBuilder(2000);\n\t\tconst renderOutput = renderViewLine(renderLineInput, sb);\n\n\t\tlet newLine;\n\t\tif (_ttPolicy) {\n\t\t\tnewLine = _ttPolicy.createHTML(sb.build());\n\t\t} else {\n\t\t\tnewLine = sb.build();\n\t\t}\n\n\t\tconst lineHTMLNode = document.createElement('span');\n\t\tlineHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n\t\tlineHTMLNode.setAttribute(STICKY_IS_LINE_ATTR, '');\n\t\tlineHTMLNode.setAttribute('role', 'listitem');\n\t\tlineHTMLNode.tabIndex = 0;\n\t\tlineHTMLNode.className = 'sticky-line-content';\n\t\tlineHTMLNode.classList.add(`stickyLine${line}`);\n\t\tlineHTMLNode.style.lineHeight = `${lineHeight}px`;\n\t\tlineHTMLNode.innerHTML = newLine as string;\n\n\t\tconst lineNumberHTMLNode = document.createElement('span');\n\t\tlineNumberHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n\t\tlineNumberHTMLNode.setAttribute(STICKY_IS_LINE_NUMBER_ATTR, '');\n\t\tlineNumberHTMLNode.className = 'sticky-line-number';\n\t\tlineNumberHTMLNode.style.lineHeight = `${lineHeight}px`;\n\t\tconst lineNumbersWidth = layoutInfo.contentLeft;\n\t\tlineNumberHTMLNode.style.width = `${lineNumbersWidth}px`;\n\n\t\tconst innerLineNumberHTML = document.createElement('span');\n\t\tif (lineNumberOption.renderType === RenderLineNumbersType.On || lineNumberOption.renderType === RenderLineNumbersType.Interval && line % 10 === 0) {\n\t\t\tinnerLineNumberHTML.innerText = line.toString();\n\t\t} else if (lineNumberOption.renderType === RenderLineNumbersType.Relative) {\n\t\t\tinnerLineNumberHTML.innerText = Math.abs(line - this._editor.getPosition()!.lineNumber).toString();\n\t\t}\n\t\tinnerLineNumberHTML.className = 'sticky-line-number-inner';\n\t\tinnerLineNumberHTML.style.width = `${layoutInfo.lineNumbersWidth}px`;\n\t\tinnerLineNumberHTML.style.paddingLeft = `${layoutInfo.lineNumbersLeft}px`;\n\n\t\tlineNumberHTMLNode.appendChild(innerLineNumberHTML);\n\t\tconst foldingIcon = this._renderFoldingIconForLine(foldingModel, line);\n\t\tif (foldingIcon) {\n\t\t\tlineNumberHTMLNode.appendChild(foldingIcon.domNode);\n\t\t\tfoldingIcon.domNode.style.left = `${layoutInfo.lineNumbersWidth + layoutInfo.lineNumbersLeft}px`;\n\t\t\tfoldingIcon.domNode.style.lineHeight = `${lineHeight}px`;\n\t\t}\n\n\t\tthis._editor.applyFontInfo(lineHTMLNode);\n\t\tthis._editor.applyFontInfo(lineNumberHTMLNode);\n\n\t\tlineNumberHTMLNode.style.lineHeight = `${lineHeight}px`;\n\t\tlineHTMLNode.style.lineHeight = `${lineHeight}px`;\n\t\tlineNumberHTMLNode.style.height = `${lineHeight}px`;\n\t\tlineHTMLNode.style.height = `${lineHeight}px`;\n\n\t\tconst renderedLine = new RenderedStickyLine(\n\t\t\tindex,\n\t\t\tline,\n\t\t\tlineHTMLNode,\n\t\t\tlineNumberHTMLNode,\n\t\t\tfoldingIcon,\n\t\t\trenderOutput.characterMapping,\n\t\t\tlineHTMLNode.scrollWidth,\n\t\t\tlineHeight\n\t\t);\n\t\treturn this._updatePosition(renderedLine, top, isLastLine);\n\t}\n\n\tprivate _updatePosition(stickyLine: RenderedStickyLine, top: number, isLastLine: boolean): RenderedStickyLine {\n\t\tconst lineHTMLNode = stickyLine.lineDomNode;\n\t\tconst lineNumberHTMLNode = stickyLine.lineNumberDomNode;\n\t\tif (isLastLine) {\n\t\t\tconst zIndex = '0';\n\t\t\tlineHTMLNode.style.zIndex = zIndex;\n\t\t\tlineNumberHTMLNode.style.zIndex = zIndex;\n\t\t\tconst updatedTop = `${top + this._lastLineRelativePosition + (stickyLine.foldingIcon?.isCollapsed ? 1 : 0)}px`;\n\t\t\tlineHTMLNode.style.top = updatedTop;\n\t\t\tlineNumberHTMLNode.style.top = updatedTop;\n\t\t} else {\n\t\t\tconst zIndex = '1';\n\t\t\tlineHTMLNode.style.zIndex = zIndex;\n\t\t\tlineNumberHTMLNode.style.zIndex = zIndex;\n\t\t\tlineHTMLNode.style.top = `${top}px`;\n\t\t\tlineNumberHTMLNode.style.top = `${top}px`;\n\t\t}\n\t\treturn stickyLine;\n\t}\n\n\tprivate _renderFoldingIconForLine(foldingModel: FoldingModel | undefined, line: number): StickyFoldingIcon | undefined {\n\t\tconst showFoldingControls: 'mouseover' | 'always' | 'never' = this._editor.getOption(EditorOption.showFoldingControls);\n\t\tif (!foldingModel || showFoldingControls === 'never') {\n\t\t\treturn;\n\t\t}\n\t\tconst foldingRegions = foldingModel.regions;\n\t\tconst indexOfFoldingRegion = foldingRegions.findRange(line);\n\t\tconst startLineNumber = foldingRegions.getStartLineNumber(indexOfFoldingRegion);\n\t\tconst isFoldingScope = line === startLineNumber;\n\t\tif (!isFoldingScope) {\n\t\t\treturn;\n\t\t}\n\t\tconst isCollapsed = foldingRegions.isCollapsed(indexOfFoldingRegion);\n\t\tconst foldingIcon = new StickyFoldingIcon(isCollapsed, startLineNumber, foldingRegions.getEndLineNumber(indexOfFoldingRegion), this._lineHeight);\n\t\tfoldingIcon.setVisible(this._isOnGlyphMargin ? true : (isCollapsed || showFoldingControls === 'always'));\n\t\tfoldingIcon.domNode.setAttribute(STICKY_IS_FOLDING_ICON_ATTR, '');\n\t\treturn foldingIcon;\n\t}\n\n\tgetId(): string {\n\t\treturn 'editor.contrib.stickyScrollWidget';\n\t}\n\n\tgetDomNode(): HTMLElement {\n\t\treturn this._rootDomNode;\n\t}\n\n\tgetPosition(): IOverlayWidgetPosition | null {\n\t\treturn {\n\t\t\tpreference: OverlayWidgetPositionPreference.TOP_CENTER,\n\t\t\tstackOridinal: 10,\n\t\t};\n\t}\n\n\tgetMinContentWidthInPx(): number {\n\t\treturn this._minContentWidthInPx;\n\t}\n\n\tfocusLineWithIndex(index: number) {\n\t\tif (0 <= index && index < this._renderedStickyLines.length) {\n\t\t\tthis._renderedStickyLines[index].lineDomNode.focus();\n\t\t}\n\t}\n\n\t/**\n\t * Given a leaf dom node, tries to find the editor position.\n\t */\n\tgetEditorPositionFromNode(spanDomNode: HTMLElement | null): Position | null {\n\t\tif (!spanDomNode || spanDomNode.children.length > 0) {\n\t\t\t// This is not a leaf node\n\t\t\treturn null;\n\t\t}\n\t\tconst renderedStickyLine = this._getRenderedStickyLineFromChildDomNode(spanDomNode);\n\t\tif (!renderedStickyLine) {\n\t\t\treturn null;\n\t\t}\n\t\tconst column = getColumnOfNodeOffset(renderedStickyLine.characterMapping, spanDomNode, 0);\n\t\treturn new Position(renderedStickyLine.lineNumber, column);\n\t}\n\n\tgetLineNumberFromChildDomNode(domNode: HTMLElement | null): number | null {\n\t\treturn this._getRenderedStickyLineFromChildDomNode(domNode)?.lineNumber ?? null;\n\t}\n\n\tprivate _getRenderedStickyLineFromChildDomNode(domNode: HTMLElement | null): RenderedStickyLine | null {\n\t\tconst index = this.getLineIndexFromChildDomNode(domNode);\n\t\tif (index === null || index < 0 || index >= this._renderedStickyLines.length) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._renderedStickyLines[index];\n\t}\n\n\t/**\n\t * Given a child dom node, tries to find the line number attribute that was stored in the node.\n\t * @returns the attribute value or null if none is found.\n\t */\n\tgetLineIndexFromChildDomNode(domNode: HTMLElement | null): number | null {\n\t\tconst lineIndex = this._getAttributeValue(domNode, STICKY_INDEX_ATTR);\n\t\treturn lineIndex ? parseInt(lineIndex, 10) : null;\n\t}\n\n\t/**\n\t * Given a child dom node, tries to find if it is (contained in) a sticky line.\n\t * @returns a boolean.\n\t */\n\tisInStickyLine(domNode: HTMLElement | null): boolean {\n\t\tconst isInLine = this._getAttributeValue(domNode, STICKY_IS_LINE_ATTR);\n\t\treturn isInLine !== undefined;\n\t}\n\n\t/**\n\t * Given a child dom node, tries to find if this dom node is (contained in) a sticky folding icon.\n\t * @returns a boolean.\n\t */\n\tisInFoldingIconDomNode(domNode: HTMLElement | null): boolean {\n\t\tconst isInFoldingIcon = this._getAttributeValue(domNode, STICKY_IS_FOLDING_ICON_ATTR);\n\t\treturn isInFoldingIcon !== undefined;\n\t}\n\n\t/**\n\t * Given the dom node, finds if it or its parent sequence contains the given attribute.\n\t * @returns the attribute value or undefined.\n\t */\n\tprivate _getAttributeValue(domNode: HTMLElement | null, attribute: string): string | undefined {\n\t\twhile (domNode && domNode !== this._rootDomNode) {\n\t\t\tconst line = domNode.getAttribute(attribute);\n\t\t\tif (line !== null) {\n\t\t\t\treturn line;\n\t\t\t}\n\t\t\tdomNode = domNode.parentElement;\n\t\t}\n\t\treturn;\n\t}\n}\n\nclass RenderedStickyLine {\n\tconstructor(\n\t\tpublic readonly index: number,\n\t\tpublic readonly lineNumber: number,\n\t\tpublic readonly lineDomNode: HTMLElement,\n\t\tpublic readonly lineNumberDomNode: HTMLElement,\n\t\tpublic readonly foldingIcon: StickyFoldingIcon | undefined,\n\t\tpublic readonly characterMapping: CharacterMapping,\n\t\tpublic readonly scrollWidth: number,\n\t\tpublic readonly height: number\n\t) { }\n}\n\nclass StickyFoldingIcon {\n\n\tpublic domNode: HTMLElement;\n\n\tconstructor(\n\t\tpublic isCollapsed: boolean,\n\t\tpublic foldingStartLine: number,\n\t\tpublic foldingEndLine: number,\n\t\tpublic dimension: number\n\t) {\n\t\tthis.domNode = document.createElement('div');\n\t\tthis.domNode.style.width = `26px`;\n\t\tthis.domNode.style.height = `${dimension}px`;\n\t\tthis.domNode.style.lineHeight = `${dimension}px`;\n\t\tthis.domNode.className = ThemeIcon.asClassName(isCollapsed ? foldingCollapsedIcon : foldingExpandedIcon);\n\t}\n\n\tpublic setVisible(visible: boolean) {\n\t\tthis.domNode.style.cursor = visible ? 'pointer' : 'default';\n\t\tthis.domNode.style.opacity = visible ? '1' : '0';\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom.js';\nimport { createTrustedTypesPolicy } from '../../../../base/browser/trustedTypes.js';\nimport { equals } from '../../../../base/common/arrays.js';\nimport { Disposable, DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport './stickyScroll.css';\nimport { ICodeEditor, IOverlayWidget, IOverlayWidgetPosition, OverlayWidgetPositionPreference } from '../../../browser/editorBrowser.js';\nimport { getColumnOfNodeOffset } from '../../../browser/viewParts/viewLines/viewLine.js';\nimport { EmbeddedCodeEditorWidget } from '../../../browser/widget/codeEditor/embeddedCodeEditorWidget.js';\nimport { EditorLayoutInfo, EditorOption, RenderLineNumbersType } from '../../../common/config/editorOptions.js';\nimport { Position } from '../../../common/core/position.js';\nimport { StringBuilder } from '../../../common/core/stringBuilder.js';\nimport { LineDecoration } from '../../../common/viewLayout/lineDecorations.js';\nimport { CharacterMapping, RenderLineInput, renderViewLine } from '../../../common/viewLayout/viewLineRenderer.js';\nimport { foldingCollapsedIcon, foldingExpandedIcon } from '../../folding/browser/foldingDecorations.js';\nimport { FoldingModel } from '../../folding/browser/foldingModel.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { IViewModel } from '../../../common/viewModel.js';\n\nexport class StickyScrollWidgetState {\n\tconstructor(\n\t\treadonly startLineNumbers: number[],\n\t\treadonly endLineNumbers: number[],\n\t\treadonly lastLineRelativePosition: number,\n\t\treadonly showEndForLine: number | null = null\n\t) { }\n\n\tequals(other: StickyScrollWidgetState | undefined): boolean {\n\t\treturn !!other\n\t\t\t&& this.lastLineRelativePosition === other.lastLineRelativePosition\n\t\t\t&& this.showEndForLine === other.showEndForLine\n\t\t\t&& equals(this.startLineNumbers, other.startLineNumbers)\n\t\t\t&& equals(this.endLineNumbers, other.endLineNumbers);\n\t}\n\n\tstatic get Empty() {\n\t\treturn new StickyScrollWidgetState([], [], 0);\n\t}\n}\n\nconst _ttPolicy = createTrustedTypesPolicy('stickyScrollViewLayer', { createHTML: value => value });\nconst STICKY_INDEX_ATTR = 'data-sticky-line-index';\nconst STICKY_IS_LINE_ATTR = 'data-sticky-is-line';\nconst STICKY_IS_LINE_NUMBER_ATTR = 'data-sticky-is-line-number';\nconst STICKY_IS_FOLDING_ICON_ATTR = 'data-sticky-is-folding-icon';\n\nexport class StickyScrollWidget extends Disposable implements IOverlayWidget {\n\n\tprivate readonly _foldingIconStore = new DisposableStore();\n\tprivate readonly _rootDomNode: HTMLElement = document.createElement('div');\n\tprivate readonly _lineNumbersDomNode: HTMLElement = document.createElement('div');\n\tprivate readonly _linesDomNodeScrollable: HTMLElement = document.createElement('div');\n\tprivate readonly _linesDomNode: HTMLElement = document.createElement('div');\n\n\tprivate readonly _editor: ICodeEditor;\n\n\tprivate _state: StickyScrollWidgetState | undefined;\n\tprivate _lineHeight: number;\n\tprivate _renderedStickyLines: RenderedStickyLine[] = [];\n\tprivate _lineNumbers: number[] = [];\n\tprivate _lastLineRelativePosition: number = 0;\n\tprivate _minContentWidthInPx: number = 0;\n\tprivate _isOnGlyphMargin: boolean = false;\n\tprivate _height: number = -1;\n\n\tpublic get height(): number { return this._height; }\n\n\tprivate readonly _onDidChangeStickyScrollHeight = this._register(new Emitter<{ height: number }>());\n\tpublic readonly onDidChangeStickyScrollHeight = this._onDidChangeStickyScrollHeight.event;\n\n\tconstructor(\n\t\teditor: ICodeEditor\n\t) {\n\t\tsuper();\n\n\t\tthis._editor = editor;\n\t\tthis._lineHeight = editor.getOption(EditorOption.lineHeight);\n\t\tthis._lineNumbersDomNode.className = 'sticky-widget-line-numbers';\n\t\tthis._lineNumbersDomNode.setAttribute('role', 'none');\n\n\t\tthis._linesDomNode.className = 'sticky-widget-lines';\n\t\tthis._linesDomNode.setAttribute('role', 'list');\n\n\t\tthis._linesDomNodeScrollable.className = 'sticky-widget-lines-scrollable';\n\t\tthis._linesDomNodeScrollable.appendChild(this._linesDomNode);\n\n\t\tthis._rootDomNode.className = 'sticky-widget';\n\t\tthis._rootDomNode.classList.toggle('peek', editor instanceof EmbeddedCodeEditorWidget);\n\t\tthis._rootDomNode.appendChild(this._lineNumbersDomNode);\n\t\tthis._rootDomNode.appendChild(this._linesDomNodeScrollable);\n\t\tthis._setHeight(0);\n\n\t\tconst updateScrollLeftPosition = () => {\n\t\t\tthis._linesDomNode.style.left = this._editor.getOption(EditorOption.stickyScroll).scrollWithEditor ? `-${this._editor.getScrollLeft()}px` : '0px';\n\t\t};\n\t\tthis._register(this._editor.onDidChangeConfiguration((e) => {\n\t\t\tif (e.hasChanged(EditorOption.stickyScroll)) {\n\t\t\t\tupdateScrollLeftPosition();\n\t\t\t}\n\t\t\tif (e.hasChanged(EditorOption.lineHeight)) {\n\t\t\t\tthis._lineHeight = this._editor.getOption(EditorOption.lineHeight);\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._editor.onDidScrollChange((e) => {\n\t\t\tif (e.scrollLeftChanged) {\n\t\t\t\tupdateScrollLeftPosition();\n\t\t\t}\n\t\t\tif (e.scrollWidthChanged) {\n\t\t\t\tthis._updateWidgetWidth();\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._editor.onDidChangeModel(() => {\n\t\t\tupdateScrollLeftPosition();\n\t\t\tthis._updateWidgetWidth();\n\t\t}));\n\t\tthis._register(this._foldingIconStore);\n\t\tupdateScrollLeftPosition();\n\n\t\tthis._register(this._editor.onDidLayoutChange((e) => {\n\t\t\tthis._updateWidgetWidth();\n\t\t}));\n\t\tthis._updateWidgetWidth();\n\t}\n\n\tget lineNumbers(): number[] {\n\t\treturn this._lineNumbers;\n\t}\n\n\tget lineNumberCount(): number {\n\t\treturn this._lineNumbers.length;\n\t}\n\n\tgetRenderedStickyLine(lineNumber: number): RenderedStickyLine | undefined {\n\t\treturn this._renderedStickyLines.find(stickyLine => stickyLine.lineNumber === lineNumber);\n\t}\n\n\tgetCurrentLines(): readonly number[] {\n\t\treturn this._lineNumbers;\n\t}\n\n\tsetState(state: StickyScrollWidgetState | undefined, foldingModel: FoldingModel | undefined, rebuildFromIndexCandidate?: number): void {\n\t\tconst currentStateAndPreviousStateUndefined = !this._state && !state;\n\t\tconst currentStateDefinedAndEqualsPreviousState = this._state && this._state.equals(state);\n\t\tif (rebuildFromIndexCandidate === undefined && (currentStateAndPreviousStateUndefined || currentStateDefinedAndEqualsPreviousState)) {\n\t\t\treturn;\n\t\t}\n\t\tconst data = this._findRenderingData(state);\n\t\tconst previousLineNumbers = this._lineNumbers;\n\t\tthis._lineNumbers = data.lineNumbers;\n\t\tthis._lastLineRelativePosition = data.lastLineRelativePosition;\n\t\tconst rebuildFromIndex = this._findIndexToRebuildFrom(previousLineNumbers, this._lineNumbers, rebuildFromIndexCandidate);\n\t\tthis._renderRootNode(this._lineNumbers, this._lastLineRelativePosition, foldingModel, rebuildFromIndex);\n\t\tthis._state = state;\n\t}\n\n\tprivate _findRenderingData(state: StickyScrollWidgetState | undefined): { lineNumbers: number[]; lastLineRelativePosition: number } {\n\t\tif (!state) {\n\t\t\treturn { lineNumbers: [], lastLineRelativePosition: 0 };\n\t\t}\n\t\tconst candidateLineNumbers = [...state.startLineNumbers];\n\t\tif (state.showEndForLine !== null) {\n\t\t\tcandidateLineNumbers[state.showEndForLine] = state.endLineNumbers[state.showEndForLine];\n\t\t}\n\t\tlet totalHeight = 0;\n\t\tfor (let i = 0; i < candidateLineNumbers.length; i++) {\n\t\t\ttotalHeight += this._editor.getLineHeightForPosition(new Position(candidateLineNumbers[i], 1));\n\t\t}\n\t\tif (totalHeight === 0) {\n\t\t\treturn { lineNumbers: [], lastLineRelativePosition: 0 };\n\t\t}\n\t\treturn { lineNumbers: candidateLineNumbers, lastLineRelativePosition: state.lastLineRelativePosition };\n\t}\n\n\tprivate _findIndexToRebuildFrom(previousLineNumbers: number[], newLineNumbers: number[], rebuildFromIndexCandidate?: number): number {\n\t\tif (newLineNumbers.length === 0) {\n\t\t\treturn 0;\n\t\t}\n\t\tif (rebuildFromIndexCandidate !== undefined) {\n\t\t\treturn rebuildFromIndexCandidate;\n\t\t}\n\t\tconst validIndex = newLineNumbers.findIndex(startLineNumber => !previousLineNumbers.includes(startLineNumber));\n\t\treturn validIndex === -1 ? 0 : validIndex;\n\t}\n\n\tprivate _updateWidgetWidth(): void {\n\t\tconst layoutInfo = this._editor.getLayoutInfo();\n\t\tconst lineNumbersWidth = layoutInfo.contentLeft;\n\t\tthis._lineNumbersDomNode.style.width = `${lineNumbersWidth}px`;\n\t\tthis._linesDomNodeScrollable.style.setProperty('--vscode-editorStickyScroll-scrollableWidth', `${this._editor.getScrollWidth() - layoutInfo.verticalScrollbarWidth}px`);\n\t\tthis._rootDomNode.style.width = `${layoutInfo.width - layoutInfo.verticalScrollbarWidth}px`;\n\t}\n\n\tprivate _useFoldingOpacityTransition(requireTransitions: boolean) {\n\t\tthis._lineNumbersDomNode.style.setProperty('--vscode-editorStickyScroll-foldingOpacityTransition', `opacity ${requireTransitions ? 0.5 : 0}s`);\n\t}\n\n\tprivate _setFoldingIconsVisibility(allVisible: boolean) {\n\t\tfor (const line of this._renderedStickyLines) {\n\t\t\tconst foldingIcon = line.foldingIcon;\n\t\t\tif (!foldingIcon) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfoldingIcon.setVisible(allVisible ? true : foldingIcon.isCollapsed);\n\t\t}\n\t}\n\n\tprivate async _renderRootNode(lineNumbers: number[], lastLineRelativePosition: number, foldingModel: FoldingModel | undefined, rebuildFromIndex: number): Promise<void> {\n\t\tconst viewModel = this._editor._getViewModel();\n\t\tif (!viewModel) {\n\t\t\tthis._clearWidget();\n\t\t\treturn;\n\t\t}\n\t\tif (lineNumbers.length === 0) {\n\t\t\tthis._clearWidget();\n\t\t\treturn;\n\t\t}\n\t\tconst renderedStickyLines: RenderedStickyLine[] = [];\n\t\tconst lastLineNumber = lineNumbers[lineNumbers.length - 1];\n\t\tlet top: number = 0;\n\t\tfor (let i = 0; i < this._renderedStickyLines.length; i++) {\n\t\t\tif (i < rebuildFromIndex) {\n\t\t\t\tconst renderedLine = this._renderedStickyLines[i];\n\t\t\t\trenderedStickyLines.push(this._updatePosition(renderedLine, top, renderedLine.lineNumber === lastLineNumber));\n\t\t\t\ttop += renderedLine.height;\n\t\t\t} else {\n\t\t\t\tconst renderedLine = this._renderedStickyLines[i];\n\t\t\t\trenderedLine.lineNumberDomNode.remove();\n\t\t\t\trenderedLine.lineDomNode.remove();\n\t\t\t}\n\t\t}\n\t\tconst layoutInfo = this._editor.getLayoutInfo();\n\t\tfor (let i = rebuildFromIndex; i < lineNumbers.length; i++) {\n\t\t\tconst stickyLine = this._renderChildNode(viewModel, i, lineNumbers[i], top, lastLineNumber === lineNumbers[i], foldingModel, layoutInfo);\n\t\t\ttop += stickyLine.height;\n\t\t\tthis._linesDomNode.appendChild(stickyLine.lineDomNode);\n\t\t\tthis._lineNumbersDomNode.appendChild(stickyLine.lineNumberDomNode);\n\t\t\trenderedStickyLines.push(stickyLine);\n\t\t}\n\t\tif (foldingModel) {\n\t\t\tthis._setFoldingHoverListeners();\n\t\t\tthis._useFoldingOpacityTransition(!this._isOnGlyphMargin);\n\t\t}\n\t\tthis._minContentWidthInPx = Math.max(...this._renderedStickyLines.map(l => l.scrollWidth)) + layoutInfo.verticalScrollbarWidth;\n\t\tthis._renderedStickyLines = renderedStickyLines;\n\t\tthis._setHeight(top + lastLineRelativePosition);\n\t\tthis._editor.layoutOverlayWidget(this);\n\t}\n\n\tprivate _clearWidget(): void {\n\t\tfor (let i = 0; i < this._renderedStickyLines.length; i++) {\n\t\t\tconst stickyLine = this._renderedStickyLines[i];\n\t\t\tstickyLine.lineNumberDomNode.remove();\n\t\t\tstickyLine.lineDomNode.remove();\n\t\t}\n\t\tthis._setHeight(0);\n\t}\n\n\tprivate _setHeight(height: number): void {\n\t\tif (this._height === height) {\n\t\t\treturn;\n\t\t}\n\t\tthis._height = height;\n\n\t\tif (this._height === 0) {\n\t\t\tthis._rootDomNode.style.display = 'none';\n\t\t} else {\n\t\t\tthis._rootDomNode.style.display = 'block';\n\t\t\tthis._lineNumbersDomNode.style.height = `${this._height}px`;\n\t\t\tthis._linesDomNodeScrollable.style.height = `${this._height}px`;\n\t\t\tthis._rootDomNode.style.height = `${this._height}px`;\n\t\t}\n\n\t\tthis._onDidChangeStickyScrollHeight.fire({ height: this._height });\n\t}\n\n\tprivate _setFoldingHoverListeners(): void {\n\t\tconst showFoldingControls: 'mouseover' | 'always' | 'never' = this._editor.getOption(EditorOption.showFoldingControls);\n\t\tif (showFoldingControls !== 'mouseover') {\n\t\t\treturn;\n\t\t}\n\t\tthis._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_ENTER, () => {\n\t\t\tthis._isOnGlyphMargin = true;\n\t\t\tthis._setFoldingIconsVisibility(true);\n\t\t}));\n\t\tthis._foldingIconStore.add(dom.addDisposableListener(this._lineNumbersDomNode, dom.EventType.MOUSE_LEAVE, () => {\n\t\t\tthis._isOnGlyphMargin = false;\n\t\t\tthis._useFoldingOpacityTransition(true);\n\t\t\tthis._setFoldingIconsVisibility(false);\n\t\t}));\n\t}\n\n\tprivate _renderChildNode(viewModel: IViewModel, index: number, line: number, top: number, isLastLine: boolean, foldingModel: FoldingModel | undefined, layoutInfo: EditorLayoutInfo): RenderedStickyLine {\n\t\tconst viewLineNumber = viewModel.coordinatesConverter.convertModelPositionToViewPosition(new Position(line, 1)).lineNumber;\n\t\tconst lineRenderingData = viewModel.getViewLineRenderingData(viewLineNumber);\n\t\tconst lineNumberOption = this._editor.getOption(EditorOption.lineNumbers);\n\t\tconst verticalScrollbarSize = this._editor.getOption(EditorOption.scrollbar).verticalScrollbarSize;\n\n\t\tlet actualInlineDecorations: LineDecoration[];\n\t\ttry {\n\t\t\tactualInlineDecorations = LineDecoration.filter(lineRenderingData.inlineDecorations, viewLineNumber, lineRenderingData.minColumn, lineRenderingData.maxColumn);\n\t\t} catch (err) {\n\t\t\tactualInlineDecorations = [];\n\t\t}\n\n\t\tconst lineHeight = this._editor.getLineHeightForPosition(new Position(line, 1));\n\t\tconst textDirection = viewModel.getTextDirection(line);\n\t\tconst renderLineInput: RenderLineInput = new RenderLineInput(true, true, lineRenderingData.content,\n\t\t\tlineRenderingData.continuesWithWrappedLine,\n\t\t\tlineRenderingData.isBasicASCII, lineRenderingData.containsRTL, 0,\n\t\t\tlineRenderingData.tokens, actualInlineDecorations,\n\t\t\tlineRenderingData.tabSize, lineRenderingData.startVisibleColumn,\n\t\t\t1, 1, 1, 500, 'none', true, true, null,\n\t\t\ttextDirection, verticalScrollbarSize\n\t\t);\n\n\t\tconst sb = new StringBuilder(2000);\n\t\tconst renderOutput = renderViewLine(renderLineInput, sb);\n\n\t\tlet newLine;\n\t\tif (_ttPolicy) {\n\t\t\tnewLine = _ttPolicy.createHTML(sb.build());\n\t\t} else {\n\t\t\tnewLine = sb.build();\n\t\t}\n\n\t\tconst lineHTMLNode = document.createElement('span');\n\t\tlineHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n\t\tlineHTMLNode.setAttribute(STICKY_IS_LINE_ATTR, '');\n\t\tlineHTMLNode.setAttribute('role', 'listitem');\n\t\tlineHTMLNode.tabIndex = 0;\n\t\tlineHTMLNode.className = 'sticky-line-content';\n\t\tlineHTMLNode.classList.add(`stickyLine${line}`);\n\t\tlineHTMLNode.style.lineHeight = `${lineHeight}px`;\n\t\tlineHTMLNode.innerHTML = newLine as string;\n\n\t\tconst lineNumberHTMLNode = document.createElement('span');\n\t\tlineNumberHTMLNode.setAttribute(STICKY_INDEX_ATTR, String(index));\n\t\tlineNumberHTMLNode.setAttribute(STICKY_IS_LINE_NUMBER_ATTR, '');\n\t\tlineNumberHTMLNode.className = 'sticky-line-number';\n\t\tlineNumberHTMLNode.style.lineHeight = `${lineHeight}px`;\n\t\tconst lineNumbersWidth = layoutInfo.contentLeft;\n\t\tlineNumberHTMLNode.style.width = `${lineNumbersWidth}px`;\n\n\t\tconst innerLineNumberHTML = document.createElement('span');\n\t\tif (lineNumberOption.renderType === RenderLineNumbersType.On || lineNumberOption.renderType === RenderLineNumbersType.Interval && line % 10 === 0) {\n\t\t\tinnerLineNumberHTML.innerText = line.toString();\n\t\t} else if (lineNumberOption.renderType === RenderLineNumbersType.Relative) {\n\t\t\tinnerLineNumberHTML.innerText = Math.abs(line - this._editor.getPosition()!.lineNumber).toString();\n\t\t}\n\t\tinnerLineNumberHTML.className = 'sticky-line-number-inner';\n\t\tinnerLineNumberHTML.style.width = `${layoutInfo.lineNumbersWidth}px`;\n\t\tinnerLineNumberHTML.style.paddingLeft = `${layoutInfo.lineNumbersLeft}px`;\n\n\t\tlineNumberHTMLNode.appendChild(innerLineNumberHTML);\n\t\tconst foldingIcon = this._renderFoldingIconForLine(foldingModel, line);\n\t\tif (foldingIcon) {\n\t\t\tlineNumberHTMLNode.appendChild(foldingIcon.domNode);\n\t\t\tfoldingIcon.domNode.style.left = `${layoutInfo.lineNumbersWidth + layoutInfo.lineNumbersLeft}px`;\n\t\t\tfoldingIcon.domNode.style.lineHeight = `${lineHeight}px`;\n\t\t}\n\n\t\tthis._editor.applyFontInfo(lineHTMLNode);\n\t\tthis._editor.applyFontInfo(lineNumberHTMLNode);\n\n\t\tlineNumberHTMLNode.style.lineHeight = `${lineHeight}px`;\n\t\tlineHTMLNode.style.lineHeight = `${lineHeight}px`;\n\t\tlineNumberHTMLNode.style.height = `${lineHeight}px`;\n\t\tlineHTMLNode.style.height = `${lineHeight}px`;\n\n\t\tconst renderedLine = new RenderedStickyLine(\n\t\t\tindex,\n\t\t\tline,\n\t\t\tlineHTMLNode,\n\t\t\tlineNumberHTMLNode,\n\t\t\tfoldingIcon,\n\t\t\trenderOutput.characterMapping,\n\t\t\tlineHTMLNode.scrollWidth,\n\t\t\tlineHeight\n\t\t);\n\t\treturn this._updatePosition(renderedLine, top, isLastLine);\n\t}\n\n\tprivate _updatePosition(stickyLine: RenderedStickyLine, top: number, isLastLine: boolean): RenderedStickyLine {\n\t\tconst lineHTMLNode = stickyLine.lineDomNode;\n\t\tconst lineNumberHTMLNode = stickyLine.lineNumberDomNode;\n\t\tif (isLastLine) {\n\t\t\tconst zIndex = '0';\n\t\t\tlineHTMLNode.style.zIndex = zIndex;\n\t\t\tlineNumberHTMLNode.style.zIndex = zIndex;\n\t\t\tconst updatedTop = `${top + this._lastLineRelativePosition + (stickyLine.foldingIcon?.isCollapsed ? 1 : 0)}px`;\n\t\t\tlineHTMLNode.style.top = updatedTop;\n\t\t\tlineNumberHTMLNode.style.top = updatedTop;\n\t\t} else {\n\t\t\tconst zIndex = '1';\n\t\t\tlineHTMLNode.style.zIndex = zIndex;\n\t\t\tlineNumberHTMLNode.style.zIndex = zIndex;\n\t\t\tlineHTMLNode.style.top = `${top}px`;\n\t\t\tlineNumberHTMLNode.style.top = `${top}px`;\n\t\t}\n\t\treturn stickyLine;\n\t}\n\n\tprivate _renderFoldingIconForLine(foldingModel: FoldingModel | undefined, line: number): StickyFoldingIcon | undefined {\n\t\tconst showFoldingControls: 'mouseover' | 'always' | 'never' = this._editor.getOption(EditorOption.showFoldingControls);\n\t\tif (!foldingModel || showFoldingControls === 'never') {\n\t\t\treturn;\n\t\t}\n\t\tconst foldingRegions = foldingModel.regions;\n\t\tconst indexOfFoldingRegion = foldingRegions.findRange(line);\n\t\tconst startLineNumber = foldingRegions.getStartLineNumber(indexOfFoldingRegion);\n\t\tconst isFoldingScope = line === startLineNumber;\n\t\tif (!isFoldingScope) {\n\t\t\treturn;\n\t\t}\n\t\tconst isCollapsed = foldingRegions.isCollapsed(indexOfFoldingRegion);\n\t\tconst foldingIcon = new StickyFoldingIcon(isCollapsed, startLineNumber, foldingRegions.getEndLineNumber(indexOfFoldingRegion), this._lineHeight);\n\t\tfoldingIcon.setVisible(this._isOnGlyphMargin ? true : (isCollapsed || showFoldingControls === 'always'));\n\t\tfoldingIcon.domNode.setAttribute(STICKY_IS_FOLDING_ICON_ATTR, '');\n\t\treturn foldingIcon;\n\t}\n\n\tgetId(): string {\n\t\treturn 'editor.contrib.stickyScrollWidget';\n\t}\n\n\tgetDomNode(): HTMLElement {\n\t\treturn this._rootDomNode;\n\t}\n\n\tgetPosition(): IOverlayWidgetPosition | null {\n\t\treturn {\n\t\t\tpreference: OverlayWidgetPositionPreference.TOP_CENTER,\n\t\t\tstackOridinal: 10,\n\t\t};\n\t}\n\n\tgetMinContentWidthInPx(): number {\n\t\treturn this._minContentWidthInPx;\n\t}\n\n\tfocusLineWithIndex(index: number) {\n\t\tif (0 <= index && index < this._renderedStickyLines.length) {\n\t\t\tthis._renderedStickyLines[index].lineDomNode.focus();\n\t\t}\n\t}\n\n\t/**\n\t * Given a leaf dom node, tries to find the editor position.\n\t */\n\tgetEditorPositionFromNode(spanDomNode: HTMLElement | null): Position | null {\n\t\tif (!spanDomNode || spanDomNode.children.length > 0) {\n\t\t\t// This is not a leaf node\n\t\t\treturn null;\n\t\t}\n\t\tconst renderedStickyLine = this._getRenderedStickyLineFromChildDomNode(spanDomNode);\n\t\tif (!renderedStickyLine) {\n\t\t\treturn null;\n\t\t}\n\t\tconst column = getColumnOfNodeOffset(renderedStickyLine.characterMapping, spanDomNode, 0);\n\t\treturn new Position(renderedStickyLine.lineNumber, column);\n\t}\n\n\tgetLineNumberFromChildDomNode(domNode: HTMLElement | null): number | null {\n\t\treturn this._getRenderedStickyLineFromChildDomNode(domNode)?.lineNumber ?? null;\n\t}\n\n\tprivate _getRenderedStickyLineFromChildDomNode(domNode: HTMLElement | null): RenderedStickyLine | null {\n\t\tconst index = this.getLineIndexFromChildDomNode(domNode);\n\t\tif (index === null || index < 0 || index >= this._renderedStickyLines.length) {\n\t\t\treturn null;\n\t\t}\n\t\treturn this._renderedStickyLines[index];\n\t}\n\n\t/**\n\t * Given a child dom node, tries to find the line number attribute that was stored in the node.\n\t * @returns the attribute value or null if none is found.\n\t */\n\tgetLineIndexFromChildDomNode(domNode: HTMLElement | null): number | null {\n\t\tconst lineIndex = this._getAttributeValue(domNode, STICKY_INDEX_ATTR);\n\t\treturn lineIndex ? parseInt(lineIndex, 10) : null;\n\t}\n\n\t/**\n\t * Given a child dom node, tries to find if it is (contained in) a sticky line.\n\t * @returns a boolean.\n\t */\n\tisInStickyLine(domNode: HTMLElement | null): boolean {\n\t\tconst isInLine = this._getAttributeValue(domNode, STICKY_IS_LINE_ATTR);\n\t\treturn isInLine !== undefined;\n\t}\n\n\t/**\n\t * Given a child dom node, tries to find if this dom node is (contained in) a sticky folding icon.\n\t * @returns a boolean.\n\t */\n\tisInFoldingIconDomNode(domNode: HTMLElement | null): boolean {\n\t\tconst isInFoldingIcon = this._getAttributeValue(domNode, STICKY_IS_FOLDING_ICON_ATTR);\n\t\treturn isInFoldingIcon !== undefined;\n\t}\n\n\t/**\n\t * Given the dom node, finds if it or its parent sequence contains the given attribute.\n\t * @returns the attribute value or undefined.\n\t */\n\tprivate _getAttributeValue(domNode: HTMLElement | null, attribute: string): string | undefined {\n\t\twhile (domNode && domNode !== this._rootDomNode) {\n\t\t\tconst line = domNode.getAttribute(attribute);\n\t\t\tif (line !== null) {\n\t\t\t\treturn line;\n\t\t\t}\n\t\t\tdomNode = domNode.parentElement;\n\t\t}\n\t\treturn;\n\t}\n}\n\nclass RenderedStickyLine {\n\tconstructor(\n\t\tpublic readonly index: number,\n\t\tpublic readonly lineNumber: number,\n\t\tpublic readonly lineDomNode: HTMLElement,\n\t\tpublic readonly lineNumberDomNode: HTMLElement,\n\t\tpublic readonly foldingIcon: StickyFoldingIcon | undefined,\n\t\tpublic readonly characterMapping: CharacterMapping,\n\t\tpublic readonly scrollWidth: number,\n\t\tpublic readonly height: number\n\t) { }\n}\n\nclass StickyFoldingIcon {\n\n\tpublic domNode: HTMLElement;\n\n\tconstructor(\n\t\tpublic isCollapsed: boolean,\n\t\tpublic foldingStartLine: number,\n\t\tpublic foldingEndLine: number,\n\t\tpublic dimension: number\n\t) {\n\t\tthis.domNode = document.createElement('div');\n\t\tthis.domNode.style.width = `26px`;\n\t\tthis.domNode.style.height = `${dimension}px`;\n\t\tthis.domNode.style.lineHeight = `${dimension}px`;\n\t\tthis.domNode.className = ThemeIcon.asClassName(isCollapsed ? foldingCollapsedIcon : foldingExpandedIcon);\n\t}\n\n\tpublic setVisible(visible: boolean) {\n\t\tthis.domNode.style.cursor = visible ? 'pointer' : 'default';\n\t\tthis.domNode.style.opacity = visible ? '1' : '0';\n\t}\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 502, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollElement.js","sourceRoot":"file:///mnt/vss/_work/1/s/dependencies/vscode/out-editor-src","sources":["file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/file%3A/mnt/vss/_work/1/s/dependencies/vscode/out-editor-src/vs/editor/contrib/stickyScroll/browser/stickyScrollElement.ts","file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/vs/editor/contrib/stickyScroll/browser/stickyScrollElement.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from '../../../../base/common/uri.js';\n\nexport class StickyRange {\n\tconstructor(\n\t\tpublic readonly startLineNumber: number,\n\t\tpublic readonly endLineNumber: number\n\t) { }\n}\n\nexport class StickyElement {\n\n\tconstructor(\n\t\t/**\n\t\t * Range of line numbers spanned by the current scope\n\t\t */\n\t\tpublic readonly range: StickyRange | undefined,\n\t\t/**\n\t\t * Must be sorted by start line number\n\t\t*/\n\t\tpublic readonly children: StickyElement[],\n\t\t/**\n\t\t * Parent sticky outline element\n\t\t */\n\t\tpublic readonly parent: StickyElement | undefined\n\t) {\n\t}\n}\n\nexport class StickyModel {\n\tconstructor(\n\t\treadonly uri: URI,\n\t\treadonly version: number,\n\t\treadonly element: StickyElement | undefined,\n\t\treadonly outlineProviderId: string | undefined\n\t) { }\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from '../../../../base/common/uri.js';\n\nexport class StickyRange {\n\tconstructor(\n\t\tpublic readonly startLineNumber: number,\n\t\tpublic readonly endLineNumber: number\n\t) { }\n}\n\nexport class StickyElement {\n\n\tconstructor(\n\t\t/**\n\t\t * Range of line numbers spanned by the current scope\n\t\t */\n\t\tpublic readonly range: StickyRange | undefined,\n\t\t/**\n\t\t * Must be sorted by start line number\n\t\t*/\n\t\tpublic readonly children: StickyElement[],\n\t\t/**\n\t\t * Parent sticky outline element\n\t\t */\n\t\tpublic readonly parent: StickyElement | undefined\n\t) {\n\t}\n}\n\nexport class StickyModel {\n\tconstructor(\n\t\treadonly uri: URI,\n\t\treadonly version: number,\n\t\treadonly element: StickyElement | undefined,\n\t\treadonly outlineProviderId: string | undefined\n\t) { }\n}\n"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;AAI1F,MAAO,WAAW;IACvB,YACiB,eAAuB,EACvB,aAAqB,CAAA;QADrB,IAAA,CAAA,eAAe,GAAf,eAAe,CAAQ;QACvB,IAAA,CAAA,aAAa,GAAb,aAAa,CAAQ;IAClC,CAAC;CACL;AAEK,MAAO,aAAa;IAEzB,YACC;;OAEG,CACa,KAA8B,EAC9C;;MAEE,CACc,QAAyB,EACzC;;OAEG,CACa,MAAiC,CAAA;QARjC,IAAA,CAAA,KAAK,GAAL,KAAK,CAAyB;QAI9B,IAAA,CAAA,QAAQ,GAAR,QAAQ,CAAiB;QAIzB,IAAA,CAAA,MAAM,GAAN,MAAM,CAA2B;IAElD,CAAC;CACD;AAEK,MAAO,WAAW;IACvB,YACU,GAAQ,EACR,OAAe,EACf,OAAkC,EAClC,iBAAqC,CAAA;QAHrC,IAAA,CAAA,GAAG,GAAH,GAAG,CAAK;QACR,IAAA,CAAA,OAAO,GAAP,OAAO,CAAQ;QACf,IAAA,CAAA,OAAO,GAAP,OAAO,CAA2B;QAClC,IAAA,CAAA,iBAAiB,GAAjB,iBAAiB,CAAoB;IAC3C,CAAC;CACL","debugId":null}},
    {"offset": {"line": 544, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollModelProvider.js","sourceRoot":"file:///mnt/vss/_work/1/s/dependencies/vscode/out-editor-src","sources":["file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/file%3A/mnt/vss/_work/1/s/dependencies/vscode/out-editor-src/vs/editor/contrib/stickyScroll/browser/stickyScrollModelProvider.ts","file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/vs/editor/contrib/stickyScroll/browser/stickyScrollModelProvider.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableStore, IDisposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { IActiveCodeEditor } from '../../../browser/editorBrowser.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { OutlineElement, OutlineGroup, OutlineModel } from '../../documentSymbols/browser/outlineModel.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { CancelablePromise, createCancelablePromise, Delayer } from '../../../../base/common/async.js';\nimport { FoldingController, RangesLimitReporter } from '../../folding/browser/folding.js';\nimport { SyntaxRangeProvider } from '../../folding/browser/syntaxRangeProvider.js';\nimport { IndentRangeProvider } from '../../folding/browser/indentRangeProvider.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { FoldingRegions } from '../../folding/browser/foldingRanges.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { StickyElement, StickyModel, StickyRange } from './stickyScrollElement.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { EditorOption } from '../../../common/config/editorOptions.js';\n\nenum ModelProvider {\n\tOUTLINE_MODEL = 'outlineModel',\n\tFOLDING_PROVIDER_MODEL = 'foldingProviderModel',\n\tINDENTATION_MODEL = 'indentationModel'\n}\n\nenum Status {\n\tVALID,\n\tINVALID,\n\tCANCELED\n}\n\nexport interface IStickyModelProvider extends IDisposable {\n\n\t/**\n\t * Method which updates the sticky model\n\t * @param token cancellation token\n\t * @returns the sticky model\n\t */\n\tupdate(token: CancellationToken): Promise<StickyModel | null>;\n}\n\nexport class StickyModelProvider extends Disposable implements IStickyModelProvider {\n\n\tprivate _modelProviders: IStickyModelCandidateProvider<any>[] = [];\n\tprivate _modelPromise: CancelablePromise<any | null> | null = null;\n\tprivate _updateScheduler: Delayer<StickyModel | null> = this._register(new Delayer<StickyModel | null>(300));\n\tprivate readonly _updateOperation: DisposableStore = this._register(new DisposableStore());\n\n\tconstructor(\n\t\tprivate readonly _editor: IActiveCodeEditor,\n\t\tonProviderUpdate: () => void,\n\t\t@IInstantiationService _languageConfigurationService: ILanguageConfigurationService,\n\t\t@ILanguageFeaturesService _languageFeaturesService: ILanguageFeaturesService,\n\t) {\n\t\tsuper();\n\n\t\tswitch (this._editor.getOption(EditorOption.stickyScroll).defaultModel) {\n\t\t\tcase ModelProvider.OUTLINE_MODEL:\n\t\t\t\tthis._modelProviders.push(new StickyModelFromCandidateOutlineProvider(this._editor, _languageFeaturesService));\n\t\t\t// fall through\n\t\t\tcase ModelProvider.FOLDING_PROVIDER_MODEL:\n\t\t\t\tthis._modelProviders.push(new StickyModelFromCandidateSyntaxFoldingProvider(this._editor, onProviderUpdate, _languageFeaturesService));\n\t\t\t// fall through\n\t\t\tcase ModelProvider.INDENTATION_MODEL:\n\t\t\t\tthis._modelProviders.push(new StickyModelFromCandidateIndentationFoldingProvider(this._editor, _languageConfigurationService));\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tpublic override dispose(): void {\n\t\tthis._modelProviders.forEach(provider => provider.dispose());\n\t\tthis._updateOperation.clear();\n\t\tthis._cancelModelPromise();\n\t\tsuper.dispose();\n\t}\n\n\tprivate _cancelModelPromise(): void {\n\t\tif (this._modelPromise) {\n\t\t\tthis._modelPromise.cancel();\n\t\t\tthis._modelPromise = null;\n\t\t}\n\t}\n\n\tpublic async update(token: CancellationToken): Promise<StickyModel | null> {\n\n\t\tthis._updateOperation.clear();\n\t\tthis._updateOperation.add({\n\t\t\tdispose: () => {\n\t\t\t\tthis._cancelModelPromise();\n\t\t\t\tthis._updateScheduler.cancel();\n\t\t\t}\n\t\t});\n\t\tthis._cancelModelPromise();\n\n\t\treturn await this._updateScheduler.trigger(async () => {\n\n\t\t\tfor (const modelProvider of this._modelProviders) {\n\t\t\t\tconst { statusPromise, modelPromise } = modelProvider.computeStickyModel(token);\n\t\t\t\tthis._modelPromise = modelPromise;\n\t\t\t\tconst status = await statusPromise;\n\t\t\t\tif (this._modelPromise !== modelPromise) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tswitch (status) {\n\t\t\t\t\tcase Status.CANCELED:\n\t\t\t\t\t\tthis._updateOperation.clear();\n\t\t\t\t\t\treturn null;\n\t\t\t\t\tcase Status.VALID:\n\t\t\t\t\t\treturn modelProvider.stickyModel;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}).catch((error) => {\n\t\t\tonUnexpectedError(error);\n\t\t\treturn null;\n\t\t});\n\t}\n}\n\ninterface IStickyModelCandidateProvider<T> extends IDisposable {\n\tget stickyModel(): StickyModel | null;\n\n\t/**\n\t * Method which computes the sticky model and returns a status to signal whether the sticky model has been successfully found\n\t * @param token cancellation token\n\t * @returns a promise of a status indicating whether the sticky model has been successfully found as well as the model promise\n\t */\n\tcomputeStickyModel(token: CancellationToken): { statusPromise: Promise<Status> | Status; modelPromise: CancelablePromise<T | null> | null };\n}\n\nabstract class StickyModelCandidateProvider<T> extends Disposable implements IStickyModelCandidateProvider<T> {\n\n\tprotected _stickyModel: StickyModel | null = null;\n\n\tconstructor(protected readonly _editor: IActiveCodeEditor) {\n\t\tsuper();\n\t}\n\n\tget stickyModel(): StickyModel | null {\n\t\treturn this._stickyModel;\n\t}\n\n\tprivate _invalid(): Status {\n\t\tthis._stickyModel = null;\n\t\treturn Status.INVALID;\n\t}\n\n\tpublic computeStickyModel(token: CancellationToken): { statusPromise: Promise<Status> | Status; modelPromise: CancelablePromise<T | null> | null } {\n\t\tif (token.isCancellationRequested || !this.isProviderValid()) {\n\t\t\treturn { statusPromise: this._invalid(), modelPromise: null };\n\t\t}\n\t\tconst providerModelPromise = createCancelablePromise(token => this.createModelFromProvider(token));\n\n\t\treturn {\n\t\t\tstatusPromise: providerModelPromise.then(providerModel => {\n\t\t\t\tif (!this.isModelValid(providerModel)) {\n\t\t\t\t\treturn this._invalid();\n\n\t\t\t\t}\n\t\t\t\tif (token.isCancellationRequested) {\n\t\t\t\t\treturn Status.CANCELED;\n\t\t\t\t}\n\t\t\t\tthis._stickyModel = this.createStickyModel(token, providerModel);\n\t\t\t\treturn Status.VALID;\n\t\t\t}).then(undefined, (err) => {\n\t\t\t\tonUnexpectedError(err);\n\t\t\t\treturn Status.CANCELED;\n\t\t\t}),\n\t\t\tmodelPromise: providerModelPromise\n\t\t};\n\t}\n\n\t/**\n\t * Method which checks whether the model returned by the provider is valid and can be used to compute a sticky model.\n\t * This method by default returns true.\n\t * @param model model returned by the provider\n\t * @returns boolean indicating whether the model is valid\n\t */\n\tprotected isModelValid(model: T): boolean {\n\t\treturn true;\n\t}\n\n\t/**\n\t * Method which checks whether the provider is valid before applying it to find the provider model.\n\t * This method by default returns true.\n\t * @returns boolean indicating whether the provider is valid\n\t */\n\tprotected isProviderValid(): boolean {\n\t\treturn true;\n\t}\n\n\t/**\n\t * Abstract method which creates the model from the provider and returns the provider model\n\t * @param token cancellation token\n\t * @returns the model returned by the provider\n\t */\n\tprotected abstract createModelFromProvider(token: CancellationToken): Promise<T>;\n\n\t/**\n\t * Abstract method which computes the sticky model from the model returned by the provider and returns the sticky model\n\t * @param token cancellation token\n\t * @param model model returned by the provider\n\t * @returns the sticky model\n\t */\n\tprotected abstract createStickyModel(token: CancellationToken, model: T): StickyModel;\n}\n\nclass StickyModelFromCandidateOutlineProvider extends StickyModelCandidateProvider<OutlineModel> {\n\n\tconstructor(_editor: IActiveCodeEditor, @ILanguageFeaturesService private readonly _languageFeaturesService: ILanguageFeaturesService) {\n\t\tsuper(_editor);\n\t}\n\n\tprotected createModelFromProvider(token: CancellationToken): Promise<OutlineModel> {\n\t\treturn OutlineModel.create(this._languageFeaturesService.documentSymbolProvider, this._editor.getModel(), token);\n\t}\n\n\tprotected createStickyModel(token: CancellationToken, model: OutlineModel): StickyModel {\n\t\tconst { stickyOutlineElement, providerID } = this._stickyModelFromOutlineModel(model, this._stickyModel?.outlineProviderId);\n\t\tconst textModel = this._editor.getModel();\n\t\treturn new StickyModel(textModel.uri, textModel.getVersionId(), stickyOutlineElement, providerID);\n\t}\n\n\tprotected override isModelValid(model: OutlineModel): boolean {\n\t\treturn model && model.children.size > 0;\n\t}\n\n\tprivate _stickyModelFromOutlineModel(outlineModel: OutlineModel, preferredProvider: string | undefined): { stickyOutlineElement: StickyElement; providerID: string | undefined } {\n\n\t\tlet outlineElements: Map<string, OutlineElement>;\n\t\t// When several possible outline providers\n\t\tif (Iterable.first(outlineModel.children.values()) instanceof OutlineGroup) {\n\t\t\tconst provider = Iterable.find(outlineModel.children.values(), outlineGroupOfModel => outlineGroupOfModel.id === preferredProvider);\n\t\t\tif (provider) {\n\t\t\t\toutlineElements = provider.children;\n\t\t\t} else {\n\t\t\t\tlet tempID = '';\n\t\t\t\tlet maxTotalSumOfRanges = -1;\n\t\t\t\tlet optimalOutlineGroup = undefined;\n\t\t\t\tfor (const [_key, outlineGroup] of outlineModel.children.entries()) {\n\t\t\t\t\tconst totalSumRanges = this._findSumOfRangesOfGroup(outlineGroup);\n\t\t\t\t\tif (totalSumRanges > maxTotalSumOfRanges) {\n\t\t\t\t\t\toptimalOutlineGroup = outlineGroup;\n\t\t\t\t\t\tmaxTotalSumOfRanges = totalSumRanges;\n\t\t\t\t\t\ttempID = outlineGroup.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tpreferredProvider = tempID;\n\t\t\t\toutlineElements = optimalOutlineGroup!.children;\n\t\t\t}\n\t\t} else {\n\t\t\toutlineElements = outlineModel.children as Map<string, OutlineElement>;\n\t\t}\n\t\tconst stickyChildren: StickyElement[] = [];\n\t\tconst outlineElementsArray = Array.from(outlineElements.values()).sort((element1, element2) => {\n\t\t\tconst range1: StickyRange = new StickyRange(element1.symbol.range.startLineNumber, element1.symbol.range.endLineNumber);\n\t\t\tconst range2: StickyRange = new StickyRange(element2.symbol.range.startLineNumber, element2.symbol.range.endLineNumber);\n\t\t\treturn this._comparator(range1, range2);\n\t\t});\n\t\tfor (const outlineElement of outlineElementsArray) {\n\t\t\tstickyChildren.push(this._stickyModelFromOutlineElement(outlineElement, outlineElement.symbol.selectionRange.startLineNumber));\n\t\t}\n\t\tconst stickyOutlineElement = new StickyElement(undefined, stickyChildren, undefined);\n\n\t\treturn {\n\t\t\tstickyOutlineElement: stickyOutlineElement,\n\t\t\tproviderID: preferredProvider\n\t\t};\n\t}\n\n\tprivate _stickyModelFromOutlineElement(outlineElement: OutlineElement, previousStartLine: number): StickyElement {\n\t\tconst children: StickyElement[] = [];\n\t\tfor (const child of outlineElement.children.values()) {\n\t\t\tif (child.symbol.selectionRange.startLineNumber !== child.symbol.range.endLineNumber) {\n\t\t\t\tif (child.symbol.selectionRange.startLineNumber !== previousStartLine) {\n\t\t\t\t\tchildren.push(this._stickyModelFromOutlineElement(child, child.symbol.selectionRange.startLineNumber));\n\t\t\t\t} else {\n\t\t\t\t\tfor (const subchild of child.children.values()) {\n\t\t\t\t\t\tchildren.push(this._stickyModelFromOutlineElement(subchild, child.symbol.selectionRange.startLineNumber));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tchildren.sort((child1, child2) => this._comparator(child1.range!, child2.range!));\n\t\tconst range = new StickyRange(outlineElement.symbol.selectionRange.startLineNumber, outlineElement.symbol.range.endLineNumber);\n\t\treturn new StickyElement(range, children, undefined);\n\t}\n\n\tprivate _comparator(range1: StickyRange, range2: StickyRange): number {\n\t\tif (range1.startLineNumber !== range2.startLineNumber) {\n\t\t\treturn range1.startLineNumber - range2.startLineNumber;\n\t\t} else {\n\t\t\treturn range2.endLineNumber - range1.endLineNumber;\n\t\t}\n\t}\n\n\tprivate _findSumOfRangesOfGroup(outline: OutlineGroup | OutlineElement): number {\n\t\tlet res = 0;\n\t\tfor (const child of outline.children.values()) {\n\t\t\tres += this._findSumOfRangesOfGroup(child);\n\t\t}\n\t\tif (outline instanceof OutlineElement) {\n\t\t\treturn res + outline.symbol.range.endLineNumber - outline.symbol.selectionRange.startLineNumber;\n\t\t} else {\n\t\t\treturn res;\n\t\t}\n\t}\n}\n\nabstract class StickyModelFromCandidateFoldingProvider extends StickyModelCandidateProvider<FoldingRegions | null> {\n\n\tprotected _foldingLimitReporter: RangesLimitReporter;\n\n\tconstructor(editor: IActiveCodeEditor) {\n\t\tsuper(editor);\n\t\tthis._foldingLimitReporter = this._register(new RangesLimitReporter(editor));\n\t}\n\n\tprotected createStickyModel(token: CancellationToken, model: FoldingRegions): StickyModel {\n\t\tconst foldingElement = this._fromFoldingRegions(model);\n\t\tconst textModel = this._editor.getModel();\n\t\treturn new StickyModel(textModel.uri, textModel.getVersionId(), foldingElement, undefined);\n\t}\n\n\tprotected override isModelValid(model: FoldingRegions): boolean {\n\t\treturn model !== null;\n\t}\n\n\n\tprivate _fromFoldingRegions(foldingRegions: FoldingRegions): StickyElement {\n\t\tconst length = foldingRegions.length;\n\t\tconst orderedStickyElements: StickyElement[] = [];\n\n\t\t// The root sticky outline element\n\t\tconst stickyOutlineElement = new StickyElement(\n\t\t\tundefined,\n\t\t\t[],\n\t\t\tundefined\n\t\t);\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\t// Finding the parent index of the current range\n\t\t\tconst parentIndex = foldingRegions.getParentIndex(i);\n\n\t\t\tlet parentNode;\n\t\t\tif (parentIndex !== -1) {\n\t\t\t\t// Access the reference of the parent node\n\t\t\t\tparentNode = orderedStickyElements[parentIndex];\n\t\t\t} else {\n\t\t\t\t// In that case the parent node is the root node\n\t\t\t\tparentNode = stickyOutlineElement;\n\t\t\t}\n\n\t\t\tconst child = new StickyElement(\n\t\t\t\tnew StickyRange(foldingRegions.getStartLineNumber(i), foldingRegions.getEndLineNumber(i) + 1),\n\t\t\t\t[],\n\t\t\t\tparentNode\n\t\t\t);\n\t\t\tparentNode.children.push(child);\n\t\t\torderedStickyElements.push(child);\n\t\t}\n\t\treturn stickyOutlineElement;\n\t}\n}\n\nclass StickyModelFromCandidateIndentationFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n\n\tprivate readonly provider: IndentRangeProvider;\n\n\tconstructor(\n\t\teditor: IActiveCodeEditor,\n\t\t@ILanguageConfigurationService private readonly _languageConfigurationService: ILanguageConfigurationService) {\n\t\tsuper(editor);\n\n\t\tthis.provider = this._register(new IndentRangeProvider(editor.getModel(), this._languageConfigurationService, this._foldingLimitReporter));\n\t}\n\n\tprotected override async createModelFromProvider(token: CancellationToken): Promise<FoldingRegions> {\n\t\treturn this.provider.compute(token);\n\t}\n}\n\nclass StickyModelFromCandidateSyntaxFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n\n\tprivate readonly provider: MutableDisposable<SyntaxRangeProvider> = this._register(new MutableDisposable<SyntaxRangeProvider>());\n\n\tconstructor(\n\t\teditor: IActiveCodeEditor,\n\t\tonProviderUpdate: () => void,\n\t\t@ILanguageFeaturesService private readonly _languageFeaturesService: ILanguageFeaturesService\n\t) {\n\t\tsuper(editor);\n\t\tthis._register(this._languageFeaturesService.foldingRangeProvider.onDidChange(() => {\n\t\t\tthis._updateProvider(editor, onProviderUpdate);\n\t\t}));\n\t\tthis._updateProvider(editor, onProviderUpdate);\n\t}\n\n\tprivate _updateProvider(editor: IActiveCodeEditor, onProviderUpdate: () => void): void {\n\t\tconst selectedProviders = FoldingController.getFoldingRangeProviders(this._languageFeaturesService, editor.getModel());\n\t\tif (selectedProviders.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tthis.provider.value = new SyntaxRangeProvider(editor.getModel(), selectedProviders, onProviderUpdate, this._foldingLimitReporter, undefined);\n\t}\n\n\tprotected override isProviderValid(): boolean {\n\t\treturn this.provider !== undefined;\n\t}\n\n\tprotected override async createModelFromProvider(token: CancellationToken): Promise<FoldingRegions | null> {\n\t\treturn this.provider.value?.compute(token) ?? null;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableStore, IDisposable, MutableDisposable } from '../../../../base/common/lifecycle.js';\nimport { IActiveCodeEditor } from '../../../browser/editorBrowser.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { OutlineElement, OutlineGroup, OutlineModel } from '../../documentSymbols/browser/outlineModel.js';\nimport { CancellationToken } from '../../../../base/common/cancellation.js';\nimport { CancelablePromise, createCancelablePromise, Delayer } from '../../../../base/common/async.js';\nimport { FoldingController, RangesLimitReporter } from '../../folding/browser/folding.js';\nimport { SyntaxRangeProvider } from '../../folding/browser/syntaxRangeProvider.js';\nimport { IndentRangeProvider } from '../../folding/browser/indentRangeProvider.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { FoldingRegions } from '../../folding/browser/foldingRanges.js';\nimport { onUnexpectedError } from '../../../../base/common/errors.js';\nimport { StickyElement, StickyModel, StickyRange } from './stickyScrollElement.js';\nimport { Iterable } from '../../../../base/common/iterator.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { EditorOption } from '../../../common/config/editorOptions.js';\n\nenum ModelProvider {\n\tOUTLINE_MODEL = 'outlineModel',\n\tFOLDING_PROVIDER_MODEL = 'foldingProviderModel',\n\tINDENTATION_MODEL = 'indentationModel'\n}\n\nenum Status {\n\tVALID,\n\tINVALID,\n\tCANCELED\n}\n\nexport interface IStickyModelProvider extends IDisposable {\n\n\t/**\n\t * Method which updates the sticky model\n\t * @param token cancellation token\n\t * @returns the sticky model\n\t */\n\tupdate(token: CancellationToken): Promise<StickyModel | null>;\n}\n\nexport class StickyModelProvider extends Disposable implements IStickyModelProvider {\n\n\tprivate _modelProviders: IStickyModelCandidateProvider<any>[] = [];\n\tprivate _modelPromise: CancelablePromise<any | null> | null = null;\n\tprivate _updateScheduler: Delayer<StickyModel | null> = this._register(new Delayer<StickyModel | null>(300));\n\tprivate readonly _updateOperation: DisposableStore = this._register(new DisposableStore());\n\n\tconstructor(\n\t\tprivate readonly _editor: IActiveCodeEditor,\n\t\tonProviderUpdate: () => void,\n\t\t@IInstantiationService _languageConfigurationService: ILanguageConfigurationService,\n\t\t@ILanguageFeaturesService _languageFeaturesService: ILanguageFeaturesService,\n\t) {\n\t\tsuper();\n\n\t\tswitch (this._editor.getOption(EditorOption.stickyScroll).defaultModel) {\n\t\t\tcase ModelProvider.OUTLINE_MODEL:\n\t\t\t\tthis._modelProviders.push(new StickyModelFromCandidateOutlineProvider(this._editor, _languageFeaturesService));\n\t\t\t// fall through\n\t\t\tcase ModelProvider.FOLDING_PROVIDER_MODEL:\n\t\t\t\tthis._modelProviders.push(new StickyModelFromCandidateSyntaxFoldingProvider(this._editor, onProviderUpdate, _languageFeaturesService));\n\t\t\t// fall through\n\t\t\tcase ModelProvider.INDENTATION_MODEL:\n\t\t\t\tthis._modelProviders.push(new StickyModelFromCandidateIndentationFoldingProvider(this._editor, _languageConfigurationService));\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tpublic override dispose(): void {\n\t\tthis._modelProviders.forEach(provider => provider.dispose());\n\t\tthis._updateOperation.clear();\n\t\tthis._cancelModelPromise();\n\t\tsuper.dispose();\n\t}\n\n\tprivate _cancelModelPromise(): void {\n\t\tif (this._modelPromise) {\n\t\t\tthis._modelPromise.cancel();\n\t\t\tthis._modelPromise = null;\n\t\t}\n\t}\n\n\tpublic async update(token: CancellationToken): Promise<StickyModel | null> {\n\n\t\tthis._updateOperation.clear();\n\t\tthis._updateOperation.add({\n\t\t\tdispose: () => {\n\t\t\t\tthis._cancelModelPromise();\n\t\t\t\tthis._updateScheduler.cancel();\n\t\t\t}\n\t\t});\n\t\tthis._cancelModelPromise();\n\n\t\treturn await this._updateScheduler.trigger(async () => {\n\n\t\t\tfor (const modelProvider of this._modelProviders) {\n\t\t\t\tconst { statusPromise, modelPromise } = modelProvider.computeStickyModel(token);\n\t\t\t\tthis._modelPromise = modelPromise;\n\t\t\t\tconst status = await statusPromise;\n\t\t\t\tif (this._modelPromise !== modelPromise) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tswitch (status) {\n\t\t\t\t\tcase Status.CANCELED:\n\t\t\t\t\t\tthis._updateOperation.clear();\n\t\t\t\t\t\treturn null;\n\t\t\t\t\tcase Status.VALID:\n\t\t\t\t\t\treturn modelProvider.stickyModel;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}).catch((error) => {\n\t\t\tonUnexpectedError(error);\n\t\t\treturn null;\n\t\t});\n\t}\n}\n\ninterface IStickyModelCandidateProvider<T> extends IDisposable {\n\tget stickyModel(): StickyModel | null;\n\n\t/**\n\t * Method which computes the sticky model and returns a status to signal whether the sticky model has been successfully found\n\t * @param token cancellation token\n\t * @returns a promise of a status indicating whether the sticky model has been successfully found as well as the model promise\n\t */\n\tcomputeStickyModel(token: CancellationToken): { statusPromise: Promise<Status> | Status; modelPromise: CancelablePromise<T | null> | null };\n}\n\nabstract class StickyModelCandidateProvider<T> extends Disposable implements IStickyModelCandidateProvider<T> {\n\n\tprotected _stickyModel: StickyModel | null = null;\n\n\tconstructor(protected readonly _editor: IActiveCodeEditor) {\n\t\tsuper();\n\t}\n\n\tget stickyModel(): StickyModel | null {\n\t\treturn this._stickyModel;\n\t}\n\n\tprivate _invalid(): Status {\n\t\tthis._stickyModel = null;\n\t\treturn Status.INVALID;\n\t}\n\n\tpublic computeStickyModel(token: CancellationToken): { statusPromise: Promise<Status> | Status; modelPromise: CancelablePromise<T | null> | null } {\n\t\tif (token.isCancellationRequested || !this.isProviderValid()) {\n\t\t\treturn { statusPromise: this._invalid(), modelPromise: null };\n\t\t}\n\t\tconst providerModelPromise = createCancelablePromise(token => this.createModelFromProvider(token));\n\n\t\treturn {\n\t\t\tstatusPromise: providerModelPromise.then(providerModel => {\n\t\t\t\tif (!this.isModelValid(providerModel)) {\n\t\t\t\t\treturn this._invalid();\n\n\t\t\t\t}\n\t\t\t\tif (token.isCancellationRequested) {\n\t\t\t\t\treturn Status.CANCELED;\n\t\t\t\t}\n\t\t\t\tthis._stickyModel = this.createStickyModel(token, providerModel);\n\t\t\t\treturn Status.VALID;\n\t\t\t}).then(undefined, (err) => {\n\t\t\t\tonUnexpectedError(err);\n\t\t\t\treturn Status.CANCELED;\n\t\t\t}),\n\t\t\tmodelPromise: providerModelPromise\n\t\t};\n\t}\n\n\t/**\n\t * Method which checks whether the model returned by the provider is valid and can be used to compute a sticky model.\n\t * This method by default returns true.\n\t * @param model model returned by the provider\n\t * @returns boolean indicating whether the model is valid\n\t */\n\tprotected isModelValid(model: T): boolean {\n\t\treturn true;\n\t}\n\n\t/**\n\t * Method which checks whether the provider is valid before applying it to find the provider model.\n\t * This method by default returns true.\n\t * @returns boolean indicating whether the provider is valid\n\t */\n\tprotected isProviderValid(): boolean {\n\t\treturn true;\n\t}\n\n\t/**\n\t * Abstract method which creates the model from the provider and returns the provider model\n\t * @param token cancellation token\n\t * @returns the model returned by the provider\n\t */\n\tprotected abstract createModelFromProvider(token: CancellationToken): Promise<T>;\n\n\t/**\n\t * Abstract method which computes the sticky model from the model returned by the provider and returns the sticky model\n\t * @param token cancellation token\n\t * @param model model returned by the provider\n\t * @returns the sticky model\n\t */\n\tprotected abstract createStickyModel(token: CancellationToken, model: T): StickyModel;\n}\n\nclass StickyModelFromCandidateOutlineProvider extends StickyModelCandidateProvider<OutlineModel> {\n\n\tconstructor(_editor: IActiveCodeEditor, @ILanguageFeaturesService private readonly _languageFeaturesService: ILanguageFeaturesService) {\n\t\tsuper(_editor);\n\t}\n\n\tprotected createModelFromProvider(token: CancellationToken): Promise<OutlineModel> {\n\t\treturn OutlineModel.create(this._languageFeaturesService.documentSymbolProvider, this._editor.getModel(), token);\n\t}\n\n\tprotected createStickyModel(token: CancellationToken, model: OutlineModel): StickyModel {\n\t\tconst { stickyOutlineElement, providerID } = this._stickyModelFromOutlineModel(model, this._stickyModel?.outlineProviderId);\n\t\tconst textModel = this._editor.getModel();\n\t\treturn new StickyModel(textModel.uri, textModel.getVersionId(), stickyOutlineElement, providerID);\n\t}\n\n\tprotected override isModelValid(model: OutlineModel): boolean {\n\t\treturn model && model.children.size > 0;\n\t}\n\n\tprivate _stickyModelFromOutlineModel(outlineModel: OutlineModel, preferredProvider: string | undefined): { stickyOutlineElement: StickyElement; providerID: string | undefined } {\n\n\t\tlet outlineElements: Map<string, OutlineElement>;\n\t\t// When several possible outline providers\n\t\tif (Iterable.first(outlineModel.children.values()) instanceof OutlineGroup) {\n\t\t\tconst provider = Iterable.find(outlineModel.children.values(), outlineGroupOfModel => outlineGroupOfModel.id === preferredProvider);\n\t\t\tif (provider) {\n\t\t\t\toutlineElements = provider.children;\n\t\t\t} else {\n\t\t\t\tlet tempID = '';\n\t\t\t\tlet maxTotalSumOfRanges = -1;\n\t\t\t\tlet optimalOutlineGroup = undefined;\n\t\t\t\tfor (const [_key, outlineGroup] of outlineModel.children.entries()) {\n\t\t\t\t\tconst totalSumRanges = this._findSumOfRangesOfGroup(outlineGroup);\n\t\t\t\t\tif (totalSumRanges > maxTotalSumOfRanges) {\n\t\t\t\t\t\toptimalOutlineGroup = outlineGroup;\n\t\t\t\t\t\tmaxTotalSumOfRanges = totalSumRanges;\n\t\t\t\t\t\ttempID = outlineGroup.id;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tpreferredProvider = tempID;\n\t\t\t\toutlineElements = optimalOutlineGroup!.children;\n\t\t\t}\n\t\t} else {\n\t\t\toutlineElements = outlineModel.children as Map<string, OutlineElement>;\n\t\t}\n\t\tconst stickyChildren: StickyElement[] = [];\n\t\tconst outlineElementsArray = Array.from(outlineElements.values()).sort((element1, element2) => {\n\t\t\tconst range1: StickyRange = new StickyRange(element1.symbol.range.startLineNumber, element1.symbol.range.endLineNumber);\n\t\t\tconst range2: StickyRange = new StickyRange(element2.symbol.range.startLineNumber, element2.symbol.range.endLineNumber);\n\t\t\treturn this._comparator(range1, range2);\n\t\t});\n\t\tfor (const outlineElement of outlineElementsArray) {\n\t\t\tstickyChildren.push(this._stickyModelFromOutlineElement(outlineElement, outlineElement.symbol.selectionRange.startLineNumber));\n\t\t}\n\t\tconst stickyOutlineElement = new StickyElement(undefined, stickyChildren, undefined);\n\n\t\treturn {\n\t\t\tstickyOutlineElement: stickyOutlineElement,\n\t\t\tproviderID: preferredProvider\n\t\t};\n\t}\n\n\tprivate _stickyModelFromOutlineElement(outlineElement: OutlineElement, previousStartLine: number): StickyElement {\n\t\tconst children: StickyElement[] = [];\n\t\tfor (const child of outlineElement.children.values()) {\n\t\t\tif (child.symbol.selectionRange.startLineNumber !== child.symbol.range.endLineNumber) {\n\t\t\t\tif (child.symbol.selectionRange.startLineNumber !== previousStartLine) {\n\t\t\t\t\tchildren.push(this._stickyModelFromOutlineElement(child, child.symbol.selectionRange.startLineNumber));\n\t\t\t\t} else {\n\t\t\t\t\tfor (const subchild of child.children.values()) {\n\t\t\t\t\t\tchildren.push(this._stickyModelFromOutlineElement(subchild, child.symbol.selectionRange.startLineNumber));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tchildren.sort((child1, child2) => this._comparator(child1.range!, child2.range!));\n\t\tconst range = new StickyRange(outlineElement.symbol.selectionRange.startLineNumber, outlineElement.symbol.range.endLineNumber);\n\t\treturn new StickyElement(range, children, undefined);\n\t}\n\n\tprivate _comparator(range1: StickyRange, range2: StickyRange): number {\n\t\tif (range1.startLineNumber !== range2.startLineNumber) {\n\t\t\treturn range1.startLineNumber - range2.startLineNumber;\n\t\t} else {\n\t\t\treturn range2.endLineNumber - range1.endLineNumber;\n\t\t}\n\t}\n\n\tprivate _findSumOfRangesOfGroup(outline: OutlineGroup | OutlineElement): number {\n\t\tlet res = 0;\n\t\tfor (const child of outline.children.values()) {\n\t\t\tres += this._findSumOfRangesOfGroup(child);\n\t\t}\n\t\tif (outline instanceof OutlineElement) {\n\t\t\treturn res + outline.symbol.range.endLineNumber - outline.symbol.selectionRange.startLineNumber;\n\t\t} else {\n\t\t\treturn res;\n\t\t}\n\t}\n}\n\nabstract class StickyModelFromCandidateFoldingProvider extends StickyModelCandidateProvider<FoldingRegions | null> {\n\n\tprotected _foldingLimitReporter: RangesLimitReporter;\n\n\tconstructor(editor: IActiveCodeEditor) {\n\t\tsuper(editor);\n\t\tthis._foldingLimitReporter = this._register(new RangesLimitReporter(editor));\n\t}\n\n\tprotected createStickyModel(token: CancellationToken, model: FoldingRegions): StickyModel {\n\t\tconst foldingElement = this._fromFoldingRegions(model);\n\t\tconst textModel = this._editor.getModel();\n\t\treturn new StickyModel(textModel.uri, textModel.getVersionId(), foldingElement, undefined);\n\t}\n\n\tprotected override isModelValid(model: FoldingRegions): boolean {\n\t\treturn model !== null;\n\t}\n\n\n\tprivate _fromFoldingRegions(foldingRegions: FoldingRegions): StickyElement {\n\t\tconst length = foldingRegions.length;\n\t\tconst orderedStickyElements: StickyElement[] = [];\n\n\t\t// The root sticky outline element\n\t\tconst stickyOutlineElement = new StickyElement(\n\t\t\tundefined,\n\t\t\t[],\n\t\t\tundefined\n\t\t);\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\t// Finding the parent index of the current range\n\t\t\tconst parentIndex = foldingRegions.getParentIndex(i);\n\n\t\t\tlet parentNode;\n\t\t\tif (parentIndex !== -1) {\n\t\t\t\t// Access the reference of the parent node\n\t\t\t\tparentNode = orderedStickyElements[parentIndex];\n\t\t\t} else {\n\t\t\t\t// In that case the parent node is the root node\n\t\t\t\tparentNode = stickyOutlineElement;\n\t\t\t}\n\n\t\t\tconst child = new StickyElement(\n\t\t\t\tnew StickyRange(foldingRegions.getStartLineNumber(i), foldingRegions.getEndLineNumber(i) + 1),\n\t\t\t\t[],\n\t\t\t\tparentNode\n\t\t\t);\n\t\t\tparentNode.children.push(child);\n\t\t\torderedStickyElements.push(child);\n\t\t}\n\t\treturn stickyOutlineElement;\n\t}\n}\n\nclass StickyModelFromCandidateIndentationFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n\n\tprivate readonly provider: IndentRangeProvider;\n\n\tconstructor(\n\t\teditor: IActiveCodeEditor,\n\t\t@ILanguageConfigurationService private readonly _languageConfigurationService: ILanguageConfigurationService) {\n\t\tsuper(editor);\n\n\t\tthis.provider = this._register(new IndentRangeProvider(editor.getModel(), this._languageConfigurationService, this._foldingLimitReporter));\n\t}\n\n\tprotected override async createModelFromProvider(token: CancellationToken): Promise<FoldingRegions> {\n\t\treturn this.provider.compute(token);\n\t}\n}\n\nclass StickyModelFromCandidateSyntaxFoldingProvider extends StickyModelFromCandidateFoldingProvider {\n\n\tprivate readonly provider: MutableDisposable<SyntaxRangeProvider> = this._register(new MutableDisposable<SyntaxRangeProvider>());\n\n\tconstructor(\n\t\teditor: IActiveCodeEditor,\n\t\tonProviderUpdate: () => void,\n\t\t@ILanguageFeaturesService private readonly _languageFeaturesService: ILanguageFeaturesService\n\t) {\n\t\tsuper(editor);\n\t\tthis._register(this._languageFeaturesService.foldingRangeProvider.onDidChange(() => {\n\t\t\tthis._updateProvider(editor, onProviderUpdate);\n\t\t}));\n\t\tthis._updateProvider(editor, onProviderUpdate);\n\t}\n\n\tprivate _updateProvider(editor: IActiveCodeEditor, onProviderUpdate: () => void): void {\n\t\tconst selectedProviders = FoldingController.getFoldingRangeProviders(this._languageFeaturesService, editor.getModel());\n\t\tif (selectedProviders.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tthis.provider.value = new SyntaxRangeProvider(editor.getModel(), selectedProviders, onProviderUpdate, this._foldingLimitReporter, undefined);\n\t}\n\n\tprotected override isProviderValid(): boolean {\n\t\treturn this.provider !== undefined;\n\t}\n\n\tprotected override async createModelFromProvider(token: CancellationToken): Promise<FoldingRegions | null> {\n\t\treturn this.provider.value?.compute(token) ?? null;\n\t}\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 899, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollProvider.js","sourceRoot":"file:///mnt/vss/_work/1/s/dependencies/vscode/out-editor-src","sources":["file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/file%3A/mnt/vss/_work/1/s/dependencies/vscode/out-editor-src/vs/editor/contrib/stickyScroll/browser/stickyScrollProvider.ts","file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/vs/editor/contrib/stickyScroll/browser/stickyScrollProvider.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ICodeEditor } from '../../../browser/editorBrowser.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { EditorOption } from '../../../common/config/editorOptions.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Event, Emitter } from '../../../../base/common/event.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { StickyModelProvider, IStickyModelProvider } from './stickyScrollModelProvider.js';\nimport { StickyElement, StickyModel, StickyRange } from './stickyScrollElement.js';\nimport { Position } from '../../../common/core/position.js';\n\nexport class StickyLineCandidate {\n\tconstructor(\n\t\tpublic readonly startLineNumber: number,\n\t\tpublic readonly endLineNumber: number,\n\t\tpublic readonly top: number,\n\t\tpublic readonly height: number,\n\t) { }\n}\n\nexport interface IStickyLineCandidateProvider {\n\t/**\n\t * Dispose resources used by the provider.\n\t */\n\tdispose(): void;\n\n\t/**\n\t * Get the version ID of the sticky model.\n\t */\n\tgetVersionId(): number | undefined;\n\n\t/**\n\t * Get sticky line candidates intersecting a given range.\n\t */\n\tgetCandidateStickyLinesIntersecting(range: StickyRange): StickyLineCandidate[];\n\n\t/**\n\t * Event triggered when sticky scroll changes.\n\t */\n\tonDidChangeStickyScroll: Event<void>;\n}\n\nexport class StickyLineCandidateProvider extends Disposable implements IStickyLineCandidateProvider {\n\n\tprivate readonly _onDidChangeStickyScroll = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeStickyScroll = this._onDidChangeStickyScroll.event;\n\n\tprivate readonly _editor: ICodeEditor;\n\tprivate readonly _updateSoon: RunOnceScheduler;\n\tprivate readonly _sessionStore: DisposableStore;\n\n\tprivate _model: StickyModel | null = null;\n\tprivate _cts: CancellationTokenSource | null = null;\n\tprivate _stickyModelProvider: IStickyModelProvider | null = null;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@ILanguageFeaturesService private readonly _languageFeaturesService: ILanguageFeaturesService,\n\t\t@ILanguageConfigurationService private readonly _languageConfigurationService: ILanguageConfigurationService,\n\t) {\n\t\tsuper();\n\t\tthis._editor = editor;\n\t\tthis._sessionStore = this._register(new DisposableStore());\n\t\tthis._updateSoon = this._register(new RunOnceScheduler(() => this.update(), 50));\n\n\t\tthis._register(this._editor.onDidChangeConfiguration(e => {\n\t\t\tif (e.hasChanged(EditorOption.stickyScroll)) {\n\t\t\t\tthis.readConfiguration();\n\t\t\t}\n\t\t}));\n\t\tthis.readConfiguration();\n\t}\n\n\t/**\n\t * Read and apply the sticky scroll configuration.\n\t */\n\tprivate readConfiguration() {\n\t\tthis._sessionStore.clear();\n\t\tconst options = this._editor.getOption(EditorOption.stickyScroll);\n\t\tif (!options.enabled) {\n\t\t\treturn;\n\t\t}\n\t\tthis._sessionStore.add(this._editor.onDidChangeModel(() => {\n\t\t\tthis._model = null;\n\t\t\tthis.updateStickyModelProvider();\n\t\t\tthis._onDidChangeStickyScroll.fire();\n\t\t\tthis.update();\n\t\t}));\n\t\tthis._sessionStore.add(this._editor.onDidChangeHiddenAreas(() => this.update()));\n\t\tthis._sessionStore.add(this._editor.onDidChangeModelContent(() => this._updateSoon.schedule()));\n\t\tthis._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => this.update()));\n\t\tthis._sessionStore.add(toDisposable(() => {\n\t\t\tthis._stickyModelProvider?.dispose();\n\t\t\tthis._stickyModelProvider = null;\n\t\t}));\n\t\tthis.updateStickyModelProvider();\n\t\tthis.update();\n\t}\n\n\t/**\n\t * Get the version ID of the sticky model.\n\t */\n\tpublic getVersionId(): number | undefined {\n\t\treturn this._model?.version;\n\t}\n\n\t/**\n\t * Update the sticky model provider.\n\t */\n\tprivate updateStickyModelProvider() {\n\t\tthis._stickyModelProvider?.dispose();\n\t\tthis._stickyModelProvider = null;\n\t\tif (this._editor.hasModel()) {\n\t\t\tthis._stickyModelProvider = new StickyModelProvider(\n\t\t\t\tthis._editor,\n\t\t\t\t() => this._updateSoon.schedule(),\n\t\t\t\tthis._languageConfigurationService,\n\t\t\t\tthis._languageFeaturesService\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Update the sticky line candidates.\n\t */\n\tpublic async update(): Promise<void> {\n\t\tthis._cts?.dispose(true);\n\t\tthis._cts = new CancellationTokenSource();\n\t\tawait this.updateStickyModel(this._cts.token);\n\t\tthis._onDidChangeStickyScroll.fire();\n\t}\n\n\t/**\n\t * Update the sticky model based on the current editor state.\n\t */\n\tprivate async updateStickyModel(token: CancellationToken): Promise<void> {\n\t\tif (!this._editor.hasModel() || !this._stickyModelProvider || this._editor.getModel().isTooLargeForTokenization()) {\n\t\t\tthis._model = null;\n\t\t\treturn;\n\t\t}\n\t\tconst model = await this._stickyModelProvider.update(token);\n\t\tif (!token.isCancellationRequested) {\n\t\t\tthis._model = model;\n\t\t}\n\t}\n\n\t/**\n\t * Get sticky line candidates intersecting a given range.\n\t */\n\tpublic getCandidateStickyLinesIntersecting(range: StickyRange): StickyLineCandidate[] {\n\t\tif (!this._model?.element) {\n\t\t\treturn [];\n\t\t}\n\t\tconst stickyLineCandidates: StickyLineCandidate[] = [];\n\t\tthis.getCandidateStickyLinesIntersectingFromStickyModel(range, this._model.element, stickyLineCandidates, 0, 0, -1);\n\t\treturn this.filterHiddenRanges(stickyLineCandidates);\n\t}\n\n\t/**\n\t * Get sticky line candidates intersecting a given range from the sticky model.\n\t */\n\tprivate getCandidateStickyLinesIntersectingFromStickyModel(\n\t\trange: StickyRange,\n\t\toutlineModel: StickyElement,\n\t\tresult: StickyLineCandidate[],\n\t\tdepth: number,\n\t\ttop: number,\n\t\tlastStartLineNumber: number\n\t): void {\n\t\tif (outlineModel.children.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tlet lastLine = lastStartLineNumber;\n\t\tconst childrenStartLines: number[] = [];\n\n\t\tfor (let i = 0; i < outlineModel.children.length; i++) {\n\t\t\tconst child = outlineModel.children[i];\n\t\t\tif (child.range) {\n\t\t\t\tchildrenStartLines.push(child.range.startLineNumber);\n\t\t\t}\n\t\t}\n\t\tconst lowerBound = this.updateIndex(binarySearch(childrenStartLines, range.startLineNumber, (a: number, b: number) => { return a - b; }));\n\t\tconst upperBound = this.updateIndex(binarySearch(childrenStartLines, range.endLineNumber, (a: number, b: number) => { return a - b; }));\n\n\t\tfor (let i = lowerBound; i <= upperBound; i++) {\n\t\t\tconst child = outlineModel.children[i];\n\t\t\tif (!child || !child.range) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst { startLineNumber, endLineNumber } = child.range;\n\t\t\tif (range.startLineNumber <= endLineNumber + 1 && startLineNumber - 1 <= range.endLineNumber && startLineNumber !== lastLine) {\n\t\t\t\tlastLine = startLineNumber;\n\t\t\t\tconst lineHeight = this._editor.getLineHeightForPosition(new Position(startLineNumber, 1));\n\t\t\t\tresult.push(new StickyLineCandidate(startLineNumber, endLineNumber - 1, top, lineHeight));\n\t\t\t\tthis.getCandidateStickyLinesIntersectingFromStickyModel(range, child, result, depth + 1, top + lineHeight, startLineNumber);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Filter out sticky line candidates that are within hidden ranges.\n\t */\n\tprivate filterHiddenRanges(stickyLineCandidates: StickyLineCandidate[]): StickyLineCandidate[] {\n\t\tconst hiddenRanges = this._editor._getViewModel()?.getHiddenAreas();\n\t\tif (!hiddenRanges) {\n\t\t\treturn stickyLineCandidates;\n\t\t}\n\t\treturn stickyLineCandidates.filter(candidate => {\n\t\t\treturn !hiddenRanges.some(hiddenRange =>\n\t\t\t\tcandidate.startLineNumber >= hiddenRange.startLineNumber &&\n\t\t\t\tcandidate.endLineNumber <= hiddenRange.endLineNumber + 1\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Update the binary search index.\n\t */\n\tprivate updateIndex(index: number): number {\n\t\tif (index === -1) {\n\t\t\treturn 0;\n\t\t} else if (index < 0) {\n\t\t\treturn -index - 2;\n\t\t}\n\t\treturn index;\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { ICodeEditor } from '../../../browser/editorBrowser.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CancellationToken, CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { EditorOption } from '../../../common/config/editorOptions.js';\nimport { RunOnceScheduler } from '../../../../base/common/async.js';\nimport { binarySearch } from '../../../../base/common/arrays.js';\nimport { Event, Emitter } from '../../../../base/common/event.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { StickyModelProvider, IStickyModelProvider } from './stickyScrollModelProvider.js';\nimport { StickyElement, StickyModel, StickyRange } from './stickyScrollElement.js';\nimport { Position } from '../../../common/core/position.js';\n\nexport class StickyLineCandidate {\n\tconstructor(\n\t\tpublic readonly startLineNumber: number,\n\t\tpublic readonly endLineNumber: number,\n\t\tpublic readonly top: number,\n\t\tpublic readonly height: number,\n\t) { }\n}\n\nexport interface IStickyLineCandidateProvider {\n\t/**\n\t * Dispose resources used by the provider.\n\t */\n\tdispose(): void;\n\n\t/**\n\t * Get the version ID of the sticky model.\n\t */\n\tgetVersionId(): number | undefined;\n\n\t/**\n\t * Get sticky line candidates intersecting a given range.\n\t */\n\tgetCandidateStickyLinesIntersecting(range: StickyRange): StickyLineCandidate[];\n\n\t/**\n\t * Event triggered when sticky scroll changes.\n\t */\n\tonDidChangeStickyScroll: Event<void>;\n}\n\nexport class StickyLineCandidateProvider extends Disposable implements IStickyLineCandidateProvider {\n\n\tprivate readonly _onDidChangeStickyScroll = this._register(new Emitter<void>());\n\tpublic readonly onDidChangeStickyScroll = this._onDidChangeStickyScroll.event;\n\n\tprivate readonly _editor: ICodeEditor;\n\tprivate readonly _updateSoon: RunOnceScheduler;\n\tprivate readonly _sessionStore: DisposableStore;\n\n\tprivate _model: StickyModel | null = null;\n\tprivate _cts: CancellationTokenSource | null = null;\n\tprivate _stickyModelProvider: IStickyModelProvider | null = null;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@ILanguageFeaturesService private readonly _languageFeaturesService: ILanguageFeaturesService,\n\t\t@ILanguageConfigurationService private readonly _languageConfigurationService: ILanguageConfigurationService,\n\t) {\n\t\tsuper();\n\t\tthis._editor = editor;\n\t\tthis._sessionStore = this._register(new DisposableStore());\n\t\tthis._updateSoon = this._register(new RunOnceScheduler(() => this.update(), 50));\n\n\t\tthis._register(this._editor.onDidChangeConfiguration(e => {\n\t\t\tif (e.hasChanged(EditorOption.stickyScroll)) {\n\t\t\t\tthis.readConfiguration();\n\t\t\t}\n\t\t}));\n\t\tthis.readConfiguration();\n\t}\n\n\t/**\n\t * Read and apply the sticky scroll configuration.\n\t */\n\tprivate readConfiguration() {\n\t\tthis._sessionStore.clear();\n\t\tconst options = this._editor.getOption(EditorOption.stickyScroll);\n\t\tif (!options.enabled) {\n\t\t\treturn;\n\t\t}\n\t\tthis._sessionStore.add(this._editor.onDidChangeModel(() => {\n\t\t\tthis._model = null;\n\t\t\tthis.updateStickyModelProvider();\n\t\t\tthis._onDidChangeStickyScroll.fire();\n\t\t\tthis.update();\n\t\t}));\n\t\tthis._sessionStore.add(this._editor.onDidChangeHiddenAreas(() => this.update()));\n\t\tthis._sessionStore.add(this._editor.onDidChangeModelContent(() => this._updateSoon.schedule()));\n\t\tthis._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(() => this.update()));\n\t\tthis._sessionStore.add(toDisposable(() => {\n\t\t\tthis._stickyModelProvider?.dispose();\n\t\t\tthis._stickyModelProvider = null;\n\t\t}));\n\t\tthis.updateStickyModelProvider();\n\t\tthis.update();\n\t}\n\n\t/**\n\t * Get the version ID of the sticky model.\n\t */\n\tpublic getVersionId(): number | undefined {\n\t\treturn this._model?.version;\n\t}\n\n\t/**\n\t * Update the sticky model provider.\n\t */\n\tprivate updateStickyModelProvider() {\n\t\tthis._stickyModelProvider?.dispose();\n\t\tthis._stickyModelProvider = null;\n\t\tif (this._editor.hasModel()) {\n\t\t\tthis._stickyModelProvider = new StickyModelProvider(\n\t\t\t\tthis._editor,\n\t\t\t\t() => this._updateSoon.schedule(),\n\t\t\t\tthis._languageConfigurationService,\n\t\t\t\tthis._languageFeaturesService\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Update the sticky line candidates.\n\t */\n\tpublic async update(): Promise<void> {\n\t\tthis._cts?.dispose(true);\n\t\tthis._cts = new CancellationTokenSource();\n\t\tawait this.updateStickyModel(this._cts.token);\n\t\tthis._onDidChangeStickyScroll.fire();\n\t}\n\n\t/**\n\t * Update the sticky model based on the current editor state.\n\t */\n\tprivate async updateStickyModel(token: CancellationToken): Promise<void> {\n\t\tif (!this._editor.hasModel() || !this._stickyModelProvider || this._editor.getModel().isTooLargeForTokenization()) {\n\t\t\tthis._model = null;\n\t\t\treturn;\n\t\t}\n\t\tconst model = await this._stickyModelProvider.update(token);\n\t\tif (!token.isCancellationRequested) {\n\t\t\tthis._model = model;\n\t\t}\n\t}\n\n\t/**\n\t * Get sticky line candidates intersecting a given range.\n\t */\n\tpublic getCandidateStickyLinesIntersecting(range: StickyRange): StickyLineCandidate[] {\n\t\tif (!this._model?.element) {\n\t\t\treturn [];\n\t\t}\n\t\tconst stickyLineCandidates: StickyLineCandidate[] = [];\n\t\tthis.getCandidateStickyLinesIntersectingFromStickyModel(range, this._model.element, stickyLineCandidates, 0, 0, -1);\n\t\treturn this.filterHiddenRanges(stickyLineCandidates);\n\t}\n\n\t/**\n\t * Get sticky line candidates intersecting a given range from the sticky model.\n\t */\n\tprivate getCandidateStickyLinesIntersectingFromStickyModel(\n\t\trange: StickyRange,\n\t\toutlineModel: StickyElement,\n\t\tresult: StickyLineCandidate[],\n\t\tdepth: number,\n\t\ttop: number,\n\t\tlastStartLineNumber: number\n\t): void {\n\t\tif (outlineModel.children.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\tlet lastLine = lastStartLineNumber;\n\t\tconst childrenStartLines: number[] = [];\n\n\t\tfor (let i = 0; i < outlineModel.children.length; i++) {\n\t\t\tconst child = outlineModel.children[i];\n\t\t\tif (child.range) {\n\t\t\t\tchildrenStartLines.push(child.range.startLineNumber);\n\t\t\t}\n\t\t}\n\t\tconst lowerBound = this.updateIndex(binarySearch(childrenStartLines, range.startLineNumber, (a: number, b: number) => { return a - b; }));\n\t\tconst upperBound = this.updateIndex(binarySearch(childrenStartLines, range.endLineNumber, (a: number, b: number) => { return a - b; }));\n\n\t\tfor (let i = lowerBound; i <= upperBound; i++) {\n\t\t\tconst child = outlineModel.children[i];\n\t\t\tif (!child || !child.range) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst { startLineNumber, endLineNumber } = child.range;\n\t\t\tif (range.startLineNumber <= endLineNumber + 1 && startLineNumber - 1 <= range.endLineNumber && startLineNumber !== lastLine) {\n\t\t\t\tlastLine = startLineNumber;\n\t\t\t\tconst lineHeight = this._editor.getLineHeightForPosition(new Position(startLineNumber, 1));\n\t\t\t\tresult.push(new StickyLineCandidate(startLineNumber, endLineNumber - 1, top, lineHeight));\n\t\t\t\tthis.getCandidateStickyLinesIntersectingFromStickyModel(range, child, result, depth + 1, top + lineHeight, startLineNumber);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Filter out sticky line candidates that are within hidden ranges.\n\t */\n\tprivate filterHiddenRanges(stickyLineCandidates: StickyLineCandidate[]): StickyLineCandidate[] {\n\t\tconst hiddenRanges = this._editor._getViewModel()?.getHiddenAreas();\n\t\tif (!hiddenRanges) {\n\t\t\treturn stickyLineCandidates;\n\t\t}\n\t\treturn stickyLineCandidates.filter(candidate => {\n\t\t\treturn !hiddenRanges.some(hiddenRange =>\n\t\t\t\tcandidate.startLineNumber >= hiddenRange.startLineNumber &&\n\t\t\t\tcandidate.endLineNumber <= hiddenRange.endLineNumber + 1\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Update the binary search index.\n\t */\n\tprivate updateIndex(index: number): number {\n\t\tif (index === -1) {\n\t\t\treturn 0;\n\t\t} else if (index < 0) {\n\t\t\treturn -index - 2;\n\t\t}\n\t\treturn index;\n\t}\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1105, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollController.js","sourceRoot":"file:///mnt/vss/_work/1/s/dependencies/vscode/out-editor-src","sources":["file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/file%3A/mnt/vss/_work/1/s/dependencies/vscode/out-editor-src/vs/editor/contrib/stickyScroll/browser/stickyScrollController.ts","file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/vs/editor/contrib/stickyScroll/browser/stickyScrollController.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { IActiveCodeEditor, ICodeEditor, MouseTargetType } from '../../../browser/editorBrowser.js';\nimport { IEditorContribution, ScrollType } from '../../../common/editorCommon.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { EditorOption, RenderLineNumbersType, ConfigurationChangedEvent } from '../../../common/config/editorOptions.js';\nimport { StickyScrollWidget, StickyScrollWidgetState } from './stickyScrollWidget.js';\nimport { IStickyLineCandidateProvider, StickyLineCandidateProvider } from './stickyScrollProvider.js';\nimport { IModelTokensChangedEvent } from '../../../common/textModelEvents.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ClickLinkGesture, ClickLinkMouseEvent } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { IRange, Range } from '../../../common/core/range.js';\nimport { getDefinitionsAtPosition } from '../../gotoSymbol/browser/goToSymbol.js';\nimport { goToDefinitionWithLocation } from '../../inlayHints/browser/inlayHintsLocations.js';\nimport { IPosition, Position } from '../../../common/core/position.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StickyRange } from './stickyScrollElement.js';\nimport { IMouseEvent, StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nimport { FoldingController } from '../../folding/browser/folding.js';\nimport { FoldingModel, toggleCollapseState } from '../../folding/browser/foldingModel.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\n\nexport interface IStickyScrollController {\n\treadonly stickyScrollWidgetHeight: number;\n\tisFocused(): boolean;\n\tfocus(): void;\n\tfocusNext(): void;\n\tfocusPrevious(): void;\n\tgoToFocused(): void;\n\tdispose(): void;\n\tselectEditor(): void;\n\tonDidChangeStickyScrollHeight: Event<{ height: number }>;\n}\n\nexport class StickyScrollController extends Disposable implements IEditorContribution, IStickyScrollController {\n\n\tstatic readonly ID = 'store.contrib.stickyScrollController';\n\n\tprivate readonly _stickyScrollWidget: StickyScrollWidget;\n\tprivate readonly _stickyLineCandidateProvider: IStickyLineCandidateProvider;\n\tprivate readonly _sessionStore: DisposableStore = new DisposableStore();\n\n\tprivate _widgetState: StickyScrollWidgetState;\n\tprivate _foldingModel: FoldingModel | undefined;\n\tprivate _maxStickyLines: number = Number.MAX_SAFE_INTEGER;\n\n\tprivate _stickyRangeProjectedOnEditor: IRange | undefined;\n\tprivate _candidateDefinitionsLength: number = -1;\n\n\tprivate _stickyScrollFocusedContextKey: IContextKey<boolean>;\n\tprivate _stickyScrollVisibleContextKey: IContextKey<boolean>;\n\n\tprivate _focusDisposableStore: DisposableStore | undefined;\n\tprivate _focusedStickyElementIndex: number = -1;\n\tprivate _enabled = false;\n\tprivate _focused = false;\n\tprivate _positionRevealed = false;\n\tprivate _onMouseDown = false;\n\tprivate _endLineNumbers: number[] = [];\n\tprivate _showEndForLine: number | undefined;\n\tprivate _minRebuildFromLine: number | undefined;\n\tprivate _mouseTarget: EventTarget | null = null;\n\n\tprivate readonly _onDidChangeStickyScrollHeight = this._register(new Emitter<{ height: number }>());\n\tpublic readonly onDidChangeStickyScrollHeight = this._onDidChangeStickyScrollHeight.event;\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService,\n\t\t@ILanguageFeaturesService private readonly _languageFeaturesService: ILanguageFeaturesService,\n\t\t@IInstantiationService private readonly _instaService: IInstantiationService,\n\t\t@ILanguageConfigurationService _languageConfigurationService: ILanguageConfigurationService,\n\t\t@ILanguageFeatureDebounceService _languageFeatureDebounceService: ILanguageFeatureDebounceService,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService\n\t) {\n\t\tsuper();\n\t\tthis._stickyScrollWidget = new StickyScrollWidget(this._editor);\n\t\tthis._stickyLineCandidateProvider = new StickyLineCandidateProvider(this._editor, _languageFeaturesService, _languageConfigurationService);\n\t\tthis._register(this._stickyScrollWidget);\n\t\tthis._register(this._stickyLineCandidateProvider);\n\n\t\tthis._widgetState = StickyScrollWidgetState.Empty;\n\t\tconst stickyScrollDomNode = this._stickyScrollWidget.getDomNode();\n\t\tthis._register(this._editor.onDidChangeLineHeight((e) => {\n\t\t\te.changes.forEach((change) => {\n\t\t\t\tconst lineNumber = change.lineNumber;\n\t\t\t\tif (this._widgetState.startLineNumbers.includes(lineNumber)) {\n\t\t\t\t\tthis._renderStickyScroll(lineNumber);\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\t\tthis._register(this._editor.onDidChangeFont((e) => {\n\t\t\te.changes.forEach((change) => {\n\t\t\t\tconst lineNumber = change.lineNumber;\n\t\t\t\tif (this._widgetState.startLineNumbers.includes(lineNumber)) {\n\t\t\t\t\tthis._renderStickyScroll(lineNumber);\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\t\tthis._register(this._editor.onDidChangeConfiguration(e => {\n\t\t\tthis._readConfigurationChange(e);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.CONTEXT_MENU, async (event: MouseEvent) => {\n\t\t\tthis._onContextMenu(dom.getWindow(stickyScrollDomNode), event);\n\t\t}));\n\t\tthis._stickyScrollFocusedContextKey = EditorContextKeys.stickyScrollFocused.bindTo(this._contextKeyService);\n\t\tthis._stickyScrollVisibleContextKey = EditorContextKeys.stickyScrollVisible.bindTo(this._contextKeyService);\n\t\tconst focusTracker = this._register(dom.trackFocus(stickyScrollDomNode));\n\t\tthis._register(focusTracker.onDidBlur(_ => {\n\t\t\t// Suppose that the blurring is caused by scrolling, then keep the focus on the sticky scroll\n\t\t\t// This is determined by the fact that the height of the widget has become zero and there has been no position revealing\n\t\t\tif (this._positionRevealed === false && stickyScrollDomNode.clientHeight === 0) {\n\t\t\t\tthis._focusedStickyElementIndex = -1;\n\t\t\t\tthis.focus();\n\n\t\t\t}\n\t\t\t// In all other casees, dispose the focus on the sticky scroll\n\t\t\telse {\n\t\t\t\tthis._disposeFocusStickyScrollStore();\n\t\t\t}\n\t\t}));\n\t\tthis._register(focusTracker.onDidFocus(_ => {\n\t\t\tthis.focus();\n\t\t}));\n\t\tthis._registerMouseListeners();\n\t\t// Suppose that mouse down on the sticky scroll, then do not focus on the sticky scroll because this will be followed by the revealing of a position\n\t\tthis._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.MOUSE_DOWN, (e) => {\n\t\t\tthis._onMouseDown = true;\n\t\t}));\n\t\tthis._register(this._stickyScrollWidget.onDidChangeStickyScrollHeight((e) => {\n\t\t\tthis._onDidChangeStickyScrollHeight.fire(e);\n\t\t}));\n\t\tthis._onDidResize();\n\t\tthis._readConfiguration();\n\t}\n\n\tget stickyScrollWidgetHeight(): number {\n\t\treturn this._stickyScrollWidget.height;\n\t}\n\n\tpublic static get(editor: ICodeEditor): IStickyScrollController | null {\n\t\treturn editor.getContribution<StickyScrollController>(StickyScrollController.ID);\n\t}\n\n\tprivate _disposeFocusStickyScrollStore() {\n\t\tthis._stickyScrollFocusedContextKey.set(false);\n\t\tthis._focusDisposableStore?.dispose();\n\t\tthis._focused = false;\n\t\tthis._positionRevealed = false;\n\t\tthis._onMouseDown = false;\n\t}\n\n\tpublic isFocused(): boolean {\n\t\treturn this._focused;\n\t}\n\n\tpublic focus(): void {\n\t\t// If the mouse is down, do not focus on the sticky scroll\n\t\tif (this._onMouseDown) {\n\t\t\tthis._onMouseDown = false;\n\t\t\tthis._editor.focus();\n\t\t\treturn;\n\t\t}\n\t\tconst focusState = this._stickyScrollFocusedContextKey.get();\n\t\tif (focusState === true) {\n\t\t\treturn;\n\t\t}\n\t\tthis._focused = true;\n\t\tthis._focusDisposableStore = new DisposableStore();\n\t\tthis._stickyScrollFocusedContextKey.set(true);\n\t\tthis._focusedStickyElementIndex = this._stickyScrollWidget.lineNumbers.length - 1;\n\t\tthis._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n\t}\n\n\tpublic focusNext(): void {\n\t\tif (this._focusedStickyElementIndex < this._stickyScrollWidget.lineNumberCount - 1) {\n\t\t\tthis._focusNav(true);\n\t\t}\n\t}\n\n\tpublic focusPrevious(): void {\n\t\tif (this._focusedStickyElementIndex > 0) {\n\t\t\tthis._focusNav(false);\n\t\t}\n\t}\n\n\tpublic selectEditor(): void {\n\t\tthis._editor.focus();\n\t}\n\n\t// True is next, false is previous\n\tprivate _focusNav(direction: boolean): void {\n\t\tthis._focusedStickyElementIndex = direction ? this._focusedStickyElementIndex + 1 : this._focusedStickyElementIndex - 1;\n\t\tthis._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n\t}\n\n\tpublic goToFocused(): void {\n\t\tconst lineNumbers = this._stickyScrollWidget.lineNumbers;\n\t\tthis._disposeFocusStickyScrollStore();\n\t\tthis._revealPosition({ lineNumber: lineNumbers[this._focusedStickyElementIndex], column: 1 });\n\t}\n\n\tprivate _revealPosition(position: IPosition): void {\n\t\tthis._reveaInEditor(position, () => this._editor.revealPosition(position));\n\t}\n\n\tprivate _revealLineInCenterIfOutsideViewport(position: IPosition): void {\n\t\tthis._reveaInEditor(position, () => this._editor.revealLineInCenterIfOutsideViewport(position.lineNumber, ScrollType.Smooth));\n\t}\n\n\tprivate _reveaInEditor(position: IPosition, revealFunction: () => void): void {\n\t\tif (this._focused) {\n\t\t\tthis._disposeFocusStickyScrollStore();\n\t\t}\n\t\tthis._positionRevealed = true;\n\t\trevealFunction();\n\t\tthis._editor.setSelection(Range.fromPositions(position));\n\t\tthis._editor.focus();\n\t}\n\n\tprivate _registerMouseListeners(): void {\n\n\t\tconst sessionStore = this._register(new DisposableStore());\n\t\tconst gesture = this._register(new ClickLinkGesture(this._editor, {\n\t\t\textractLineNumberFromMouseEvent: (e) => {\n\t\t\t\tconst position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n\t\t\t\treturn position ? position.lineNumber : 0;\n\t\t\t}\n\t\t}));\n\n\t\tconst getMouseEventTarget = (mouseEvent: ClickLinkMouseEvent): { range: Range; textElement: HTMLElement } | null => {\n\t\t\tif (!this._editor.hasModel()) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif (mouseEvent.target.type !== MouseTargetType.OVERLAY_WIDGET || mouseEvent.target.detail !== this._stickyScrollWidget.getId()) {\n\t\t\t\t// not hovering over our widget\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst mouseTargetElement = mouseEvent.target.element;\n\t\t\tif (!mouseTargetElement || mouseTargetElement.innerText !== mouseTargetElement.innerHTML) {\n\t\t\t\t// not on a span element rendering text\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst position = this._stickyScrollWidget.getEditorPositionFromNode(mouseTargetElement);\n\t\t\tif (!position) {\n\t\t\t\t// not hovering a sticky scroll line\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\trange: new Range(position.lineNumber, position.column, position.lineNumber, position.column + mouseTargetElement.innerText.length),\n\t\t\t\ttextElement: mouseTargetElement\n\t\t\t};\n\t\t};\n\n\t\tconst stickyScrollWidgetDomNode = this._stickyScrollWidget.getDomNode();\n\t\tthis._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.CLICK, (mouseEvent: IMouseEvent) => {\n\t\t\tif (mouseEvent.ctrlKey || mouseEvent.altKey || mouseEvent.metaKey) {\n\t\t\t\t// modifier pressed\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!mouseEvent.leftButton) {\n\t\t\t\t// not left click\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (mouseEvent.shiftKey) {\n\t\t\t\t// shift click\n\t\t\t\tconst lineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n\t\t\t\tif (lineIndex === null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst position = new Position(this._endLineNumbers[lineIndex], 1);\n\t\t\t\tthis._revealLineInCenterIfOutsideViewport(position);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst isInFoldingIconDomNode = this._stickyScrollWidget.isInFoldingIconDomNode(mouseEvent.target);\n\t\t\tif (isInFoldingIconDomNode) {\n\t\t\t\t// clicked on folding icon\n\t\t\t\tconst lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n\t\t\t\tthis._toggleFoldingRegionForLine(lineNumber);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst isInStickyLine = this._stickyScrollWidget.isInStickyLine(mouseEvent.target);\n\t\t\tif (!isInStickyLine) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// normal click\n\t\t\tlet position = this._stickyScrollWidget.getEditorPositionFromNode(mouseEvent.target);\n\t\t\tif (!position) {\n\t\t\t\tconst lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n\t\t\t\tif (lineNumber === null) {\n\t\t\t\t\t// not hovering a sticky scroll line\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tposition = new Position(lineNumber, 1);\n\t\t\t}\n\t\t\tthis._revealPosition(position);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(mainWindow, dom.EventType.MOUSE_MOVE, mouseEvent => {\n\t\t\tthis._mouseTarget = mouseEvent.target;\n\t\t\tthis._onMouseMoveOrKeyDown(mouseEvent);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(mainWindow, dom.EventType.KEY_DOWN, mouseEvent => {\n\t\t\tthis._onMouseMoveOrKeyDown(mouseEvent);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(mainWindow, dom.EventType.KEY_UP, () => {\n\t\t\tif (this._showEndForLine !== undefined) {\n\t\t\t\tthis._showEndForLine = undefined;\n\t\t\t\tthis._renderStickyScroll();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(gesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, _keyboardEvent]) => {\n\t\t\tconst mouseTarget = getMouseEventTarget(mouseEvent);\n\t\t\tif (!mouseTarget || !mouseEvent.hasTriggerModifier || !this._editor.hasModel()) {\n\t\t\t\tsessionStore.clear();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { range, textElement } = mouseTarget;\n\n\t\t\tif (!range.equalsRange(this._stickyRangeProjectedOnEditor)) {\n\t\t\t\tthis._stickyRangeProjectedOnEditor = range;\n\t\t\t\tsessionStore.clear();\n\t\t\t} else if (textElement.style.textDecoration === 'underline') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst cancellationToken = new CancellationTokenSource();\n\t\t\tsessionStore.add(toDisposable(() => cancellationToken.dispose(true)));\n\n\t\t\tlet currentHTMLChild: HTMLElement;\n\n\t\t\tgetDefinitionsAtPosition(this._languageFeaturesService.definitionProvider, this._editor.getModel(), new Position(range.startLineNumber, range.startColumn + 1), false, cancellationToken.token).then((candidateDefinitions => {\n\t\t\t\tif (cancellationToken.token.isCancellationRequested) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (candidateDefinitions.length !== 0) {\n\t\t\t\t\tthis._candidateDefinitionsLength = candidateDefinitions.length;\n\t\t\t\t\tconst childHTML: HTMLElement = textElement;\n\t\t\t\t\tif (currentHTMLChild !== childHTML) {\n\t\t\t\t\t\tsessionStore.clear();\n\t\t\t\t\t\tcurrentHTMLChild = childHTML;\n\t\t\t\t\t\tcurrentHTMLChild.style.textDecoration = 'underline';\n\t\t\t\t\t\tsessionStore.add(toDisposable(() => {\n\t\t\t\t\t\t\tcurrentHTMLChild.style.textDecoration = 'none';\n\t\t\t\t\t\t}));\n\t\t\t\t\t} else if (!currentHTMLChild) {\n\t\t\t\t\t\tcurrentHTMLChild = childHTML;\n\t\t\t\t\t\tcurrentHTMLChild.style.textDecoration = 'underline';\n\t\t\t\t\t\tsessionStore.add(toDisposable(() => {\n\t\t\t\t\t\t\tcurrentHTMLChild.style.textDecoration = 'none';\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsessionStore.clear();\n\t\t\t\t}\n\t\t\t}));\n\t\t}));\n\t\tthis._register(gesture.onCancel(() => {\n\t\t\tsessionStore.clear();\n\t\t}));\n\t\tthis._register(gesture.onExecute(async e => {\n\t\t\tif (e.target.type !== MouseTargetType.OVERLAY_WIDGET || e.target.detail !== this._stickyScrollWidget.getId()) {\n\t\t\t\t// not hovering over our widget\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n\t\t\tif (!position) {\n\t\t\t\t// not hovering a sticky scroll line\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!this._editor.hasModel() || !this._stickyRangeProjectedOnEditor) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._candidateDefinitionsLength > 1) {\n\t\t\t\tif (this._focused) {\n\t\t\t\t\tthis._disposeFocusStickyScrollStore();\n\t\t\t\t}\n\t\t\t\tthis._revealPosition({ lineNumber: position.lineNumber, column: 1 });\n\t\t\t}\n\t\t\tthis._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor as IActiveCodeEditor, { uri: this._editor.getModel().uri, range: this._stickyRangeProjectedOnEditor });\n\t\t}));\n\t}\n\n\tprivate _onContextMenu(targetWindow: Window, e: MouseEvent) {\n\t\tconst event = new StandardMouseEvent(targetWindow, e);\n\n\t\tthis._contextMenuService.showContextMenu({\n\t\t\tmenuId: MenuId.StickyScrollContext,\n\t\t\tgetAnchor: () => event,\n\t\t});\n\t}\n\n\tprivate _onMouseMoveOrKeyDown(mouseEvent: KeyboardEvent | MouseEvent): void {\n\t\tif (!mouseEvent.shiftKey) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this._mouseTarget || !dom.isHTMLElement(this._mouseTarget)) {\n\t\t\treturn;\n\t\t}\n\t\tconst currentEndForLineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(this._mouseTarget);\n\t\tif (currentEndForLineIndex === null || this._showEndForLine === currentEndForLineIndex) {\n\t\t\treturn;\n\t\t}\n\t\tthis._showEndForLine = currentEndForLineIndex;\n\t\tthis._renderStickyScroll();\n\t}\n\n\tprivate _toggleFoldingRegionForLine(line: number | null) {\n\t\tif (!this._foldingModel || line === null) {\n\t\t\treturn;\n\t\t}\n\t\tconst stickyLine = this._stickyScrollWidget.getRenderedStickyLine(line);\n\t\tconst foldingIcon = stickyLine?.foldingIcon;\n\t\tif (!foldingIcon) {\n\t\t\treturn;\n\t\t}\n\t\ttoggleCollapseState(this._foldingModel, 1, [line]);\n\t\tfoldingIcon.isCollapsed = !foldingIcon.isCollapsed;\n\t\tconst scrollTop = (foldingIcon.isCollapsed ?\n\t\t\tthis._editor.getTopForLineNumber(foldingIcon.foldingEndLine)\n\t\t\t: this._editor.getTopForLineNumber(foldingIcon.foldingStartLine))\n\t\t\t- this._editor.getOption(EditorOption.lineHeight) * stickyLine.index + 1;\n\t\tthis._editor.setScrollTop(scrollTop);\n\t\tthis._renderStickyScroll(line);\n\t}\n\n\tprivate _readConfiguration() {\n\t\tconst options = this._editor.getOption(EditorOption.stickyScroll);\n\t\tif (options.enabled === false) {\n\t\t\tthis._editor.removeOverlayWidget(this._stickyScrollWidget);\n\t\t\tthis._resetState();\n\t\t\tthis._sessionStore.clear();\n\t\t\tthis._enabled = false;\n\t\t\treturn;\n\t\t} else if (options.enabled && !this._enabled) {\n\t\t\t// When sticky scroll was just enabled, add the listeners on the sticky scroll\n\t\t\tthis._editor.addOverlayWidget(this._stickyScrollWidget);\n\t\t\tthis._sessionStore.add(this._editor.onDidScrollChange((e) => {\n\t\t\t\tif (e.scrollTopChanged) {\n\t\t\t\t\tthis._showEndForLine = undefined;\n\t\t\t\t\tthis._renderStickyScroll();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis._sessionStore.add(this._editor.onDidLayoutChange(() => this._onDidResize()));\n\t\t\tthis._sessionStore.add(this._editor.onDidChangeModelTokens((e) => this._onTokensChange(e)));\n\t\t\tthis._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(() => {\n\t\t\t\tthis._showEndForLine = undefined;\n\t\t\t\tthis._renderStickyScroll();\n\t\t\t}));\n\t\t\tthis._enabled = true;\n\t\t}\n\n\t\tconst lineNumberOption = this._editor.getOption(EditorOption.lineNumbers);\n\t\tif (lineNumberOption.renderType === RenderLineNumbersType.Relative) {\n\t\t\tthis._sessionStore.add(this._editor.onDidChangeCursorPosition(() => {\n\t\t\t\tthis._showEndForLine = undefined;\n\t\t\t\tthis._renderStickyScroll(0);\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate _readConfigurationChange(event: ConfigurationChangedEvent) {\n\t\tif (\n\t\t\tevent.hasChanged(EditorOption.stickyScroll)\n\t\t\t|| event.hasChanged(EditorOption.minimap)\n\t\t\t|| event.hasChanged(EditorOption.lineHeight)\n\t\t\t|| event.hasChanged(EditorOption.showFoldingControls)\n\t\t\t|| event.hasChanged(EditorOption.lineNumbers)\n\t\t) {\n\t\t\tthis._readConfiguration();\n\t\t}\n\n\t\tif (event.hasChanged(EditorOption.lineNumbers) || event.hasChanged(EditorOption.folding) || event.hasChanged(EditorOption.showFoldingControls)) {\n\t\t\tthis._renderStickyScroll(0);\n\t\t}\n\t}\n\n\tprivate _needsUpdate(event: IModelTokensChangedEvent) {\n\t\tconst stickyLineNumbers = this._stickyScrollWidget.getCurrentLines();\n\t\tfor (const stickyLineNumber of stickyLineNumbers) {\n\t\t\tfor (const range of event.ranges) {\n\t\t\t\tif (stickyLineNumber >= range.fromLineNumber && stickyLineNumber <= range.toLineNumber) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _onTokensChange(event: IModelTokensChangedEvent) {\n\t\tif (this._needsUpdate(event)) {\n\t\t\t// Rebuilding the whole widget from line 0\n\t\t\tthis._renderStickyScroll(0);\n\t\t}\n\t}\n\n\tprivate _onDidResize() {\n\t\tconst layoutInfo = this._editor.getLayoutInfo();\n\t\t// Make sure sticky scroll doesn't take up more than 25% of the editor\n\t\tconst theoreticalLines = layoutInfo.height / this._editor.getOption(EditorOption.lineHeight);\n\t\tthis._maxStickyLines = Math.round(theoreticalLines * .25);\n\t\tthis._renderStickyScroll(0);\n\t}\n\n\tprivate async _renderStickyScroll(rebuildFromLine?: number): Promise<void> {\n\t\tconst model = this._editor.getModel();\n\t\tif (!model || model.isTooLargeForTokenization()) {\n\t\t\tthis._resetState();\n\t\t\treturn;\n\t\t}\n\t\tconst nextRebuildFromLine = this._updateAndGetMinRebuildFromLine(rebuildFromLine);\n\t\tconst stickyWidgetVersion = this._stickyLineCandidateProvider.getVersionId();\n\t\tconst shouldUpdateState = stickyWidgetVersion === undefined || stickyWidgetVersion === model.getVersionId();\n\t\tif (shouldUpdateState) {\n\t\t\tif (!this._focused) {\n\t\t\t\tawait this._updateState(nextRebuildFromLine);\n\t\t\t} else {\n\t\t\t\t// Suppose that previously the sticky scroll widget had height 0, then if there are visible lines, set the last line as focused\n\t\t\t\tif (this._focusedStickyElementIndex === -1) {\n\t\t\t\t\tawait this._updateState(nextRebuildFromLine);\n\t\t\t\t\tthis._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n\t\t\t\t\tif (this._focusedStickyElementIndex !== -1) {\n\t\t\t\t\t\tthis._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst focusedStickyElementLineNumber = this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];\n\t\t\t\t\tawait this._updateState(nextRebuildFromLine);\n\t\t\t\t\t// Suppose that after setting the state, there are no sticky lines, set the focused index to -1\n\t\t\t\t\tif (this._stickyScrollWidget.lineNumberCount === 0) {\n\t\t\t\t\t\tthis._focusedStickyElementIndex = -1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst previousFocusedLineNumberExists = this._stickyScrollWidget.lineNumbers.includes(focusedStickyElementLineNumber);\n\n\t\t\t\t\t\t// If the line number is still there, do not change anything\n\t\t\t\t\t\t// If the line number is not there, set the new focused line to be the last line\n\t\t\t\t\t\tif (!previousFocusedLineNumberExists) {\n\t\t\t\t\t\t\tthis._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _updateAndGetMinRebuildFromLine(rebuildFromLine: number | undefined): number | undefined {\n\t\tif (rebuildFromLine !== undefined) {\n\t\t\tconst minRebuildFromLineOrInfinity = this._minRebuildFromLine !== undefined ? this._minRebuildFromLine : Infinity;\n\t\t\tthis._minRebuildFromLine = Math.min(rebuildFromLine, minRebuildFromLineOrInfinity);\n\t\t}\n\t\treturn this._minRebuildFromLine;\n\t}\n\n\tprivate async _updateState(rebuildFromLine?: number): Promise<void> {\n\t\tthis._minRebuildFromLine = undefined;\n\t\tthis._foldingModel = await FoldingController.get(this._editor)?.getFoldingModel() ?? undefined;\n\t\tthis._widgetState = this.findScrollWidgetState();\n\t\tconst stickyWidgetHasLines = this._widgetState.startLineNumbers.length > 0;\n\t\tthis._stickyScrollVisibleContextKey.set(stickyWidgetHasLines);\n\t\tthis._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n\t}\n\n\tprivate async _resetState(): Promise<void> {\n\t\tthis._minRebuildFromLine = undefined;\n\t\tthis._foldingModel = undefined;\n\t\tthis._widgetState = StickyScrollWidgetState.Empty;\n\t\tthis._stickyScrollVisibleContextKey.set(false);\n\t\tthis._stickyScrollWidget.setState(undefined, undefined);\n\t}\n\n\tfindScrollWidgetState(): StickyScrollWidgetState {\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn StickyScrollWidgetState.Empty;\n\t\t}\n\t\tconst textModel = this._editor.getModel();\n\t\tconst maxNumberStickyLines = Math.min(this._maxStickyLines, this._editor.getOption(EditorOption.stickyScroll).maxLineCount);\n\t\tconst scrollTop: number = this._editor.getScrollTop();\n\t\tlet lastLineRelativePosition: number = 0;\n\t\tconst startLineNumbers: number[] = [];\n\t\tconst endLineNumbers: number[] = [];\n\t\tconst arrayVisibleRanges = this._editor.getVisibleRanges();\n\t\tif (arrayVisibleRanges.length !== 0) {\n\t\t\tconst fullVisibleRange = new StickyRange(arrayVisibleRanges[0].startLineNumber, arrayVisibleRanges[arrayVisibleRanges.length - 1].endLineNumber);\n\t\t\tconst candidateRanges = this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(fullVisibleRange);\n\t\t\tfor (const range of candidateRanges) {\n\t\t\t\tconst start = range.startLineNumber;\n\t\t\t\tconst end = range.endLineNumber;\n\t\t\t\tconst isValidRange = textModel.isValidRange({ startLineNumber: start, endLineNumber: end, startColumn: 1, endColumn: 1 });\n\t\t\t\tif (isValidRange && end - start > 0) {\n\t\t\t\t\tconst topOfElement = range.top;\n\t\t\t\t\tconst bottomOfElement = topOfElement + range.height;\n\t\t\t\t\tconst topOfBeginningLine = this._editor.getTopForLineNumber(start) - scrollTop;\n\t\t\t\t\tconst bottomOfEndLine = this._editor.getBottomForLineNumber(end) - scrollTop;\n\t\t\t\t\tif (topOfElement > topOfBeginningLine && topOfElement <= bottomOfEndLine) {\n\t\t\t\t\t\tstartLineNumbers.push(start);\n\t\t\t\t\t\tendLineNumbers.push(end + 1);\n\t\t\t\t\t\tif (bottomOfElement > bottomOfEndLine) {\n\t\t\t\t\t\t\tlastLineRelativePosition = bottomOfEndLine - bottomOfElement;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (startLineNumbers.length === maxNumberStickyLines) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._endLineNumbers = endLineNumbers;\n\t\treturn new StickyScrollWidgetState(startLineNumbers, endLineNumbers, lastLineRelativePosition, this._showEndForLine);\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t\tthis._sessionStore.dispose();\n\t}\n}\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { IActiveCodeEditor, ICodeEditor, MouseTargetType } from '../../../browser/editorBrowser.js';\nimport { IEditorContribution, ScrollType } from '../../../common/editorCommon.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { EditorOption, RenderLineNumbersType, ConfigurationChangedEvent } from '../../../common/config/editorOptions.js';\nimport { StickyScrollWidget, StickyScrollWidgetState } from './stickyScrollWidget.js';\nimport { IStickyLineCandidateProvider, StickyLineCandidateProvider } from './stickyScrollProvider.js';\nimport { IModelTokensChangedEvent } from '../../../common/textModelEvents.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IContextKey, IContextKeyService } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ClickLinkGesture, ClickLinkMouseEvent } from '../../gotoSymbol/browser/link/clickLinkGesture.js';\nimport { IRange, Range } from '../../../common/core/range.js';\nimport { getDefinitionsAtPosition } from '../../gotoSymbol/browser/goToSymbol.js';\nimport { goToDefinitionWithLocation } from '../../inlayHints/browser/inlayHintsLocations.js';\nimport { IPosition, Position } from '../../../common/core/position.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { ILanguageConfigurationService } from '../../../common/languages/languageConfigurationRegistry.js';\nimport { ILanguageFeatureDebounceService } from '../../../common/services/languageFeatureDebounce.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StickyRange } from './stickyScrollElement.js';\nimport { IMouseEvent, StandardMouseEvent } from '../../../../base/browser/mouseEvent.js';\nimport { FoldingController } from '../../folding/browser/folding.js';\nimport { FoldingModel, toggleCollapseState } from '../../folding/browser/foldingModel.js';\nimport { Emitter, Event } from '../../../../base/common/event.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\n\nexport interface IStickyScrollController {\n\treadonly stickyScrollWidgetHeight: number;\n\tisFocused(): boolean;\n\tfocus(): void;\n\tfocusNext(): void;\n\tfocusPrevious(): void;\n\tgoToFocused(): void;\n\tdispose(): void;\n\tselectEditor(): void;\n\tonDidChangeStickyScrollHeight: Event<{ height: number }>;\n}\n\nexport class StickyScrollController extends Disposable implements IEditorContribution, IStickyScrollController {\n\n\tstatic readonly ID = 'store.contrib.stickyScrollController';\n\n\tprivate readonly _stickyScrollWidget: StickyScrollWidget;\n\tprivate readonly _stickyLineCandidateProvider: IStickyLineCandidateProvider;\n\tprivate readonly _sessionStore: DisposableStore = new DisposableStore();\n\n\tprivate _widgetState: StickyScrollWidgetState;\n\tprivate _foldingModel: FoldingModel | undefined;\n\tprivate _maxStickyLines: number = Number.MAX_SAFE_INTEGER;\n\n\tprivate _stickyRangeProjectedOnEditor: IRange | undefined;\n\tprivate _candidateDefinitionsLength: number = -1;\n\n\tprivate _stickyScrollFocusedContextKey: IContextKey<boolean>;\n\tprivate _stickyScrollVisibleContextKey: IContextKey<boolean>;\n\n\tprivate _focusDisposableStore: DisposableStore | undefined;\n\tprivate _focusedStickyElementIndex: number = -1;\n\tprivate _enabled = false;\n\tprivate _focused = false;\n\tprivate _positionRevealed = false;\n\tprivate _onMouseDown = false;\n\tprivate _endLineNumbers: number[] = [];\n\tprivate _showEndForLine: number | undefined;\n\tprivate _minRebuildFromLine: number | undefined;\n\tprivate _mouseTarget: EventTarget | null = null;\n\n\tprivate readonly _onDidChangeStickyScrollHeight = this._register(new Emitter<{ height: number }>());\n\tpublic readonly onDidChangeStickyScrollHeight = this._onDidChangeStickyScrollHeight.event;\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService,\n\t\t@ILanguageFeaturesService private readonly _languageFeaturesService: ILanguageFeaturesService,\n\t\t@IInstantiationService private readonly _instaService: IInstantiationService,\n\t\t@ILanguageConfigurationService _languageConfigurationService: ILanguageConfigurationService,\n\t\t@ILanguageFeatureDebounceService _languageFeatureDebounceService: ILanguageFeatureDebounceService,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService\n\t) {\n\t\tsuper();\n\t\tthis._stickyScrollWidget = new StickyScrollWidget(this._editor);\n\t\tthis._stickyLineCandidateProvider = new StickyLineCandidateProvider(this._editor, _languageFeaturesService, _languageConfigurationService);\n\t\tthis._register(this._stickyScrollWidget);\n\t\tthis._register(this._stickyLineCandidateProvider);\n\n\t\tthis._widgetState = StickyScrollWidgetState.Empty;\n\t\tconst stickyScrollDomNode = this._stickyScrollWidget.getDomNode();\n\t\tthis._register(this._editor.onDidChangeLineHeight((e) => {\n\t\t\te.changes.forEach((change) => {\n\t\t\t\tconst lineNumber = change.lineNumber;\n\t\t\t\tif (this._widgetState.startLineNumbers.includes(lineNumber)) {\n\t\t\t\t\tthis._renderStickyScroll(lineNumber);\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\t\tthis._register(this._editor.onDidChangeFont((e) => {\n\t\t\te.changes.forEach((change) => {\n\t\t\t\tconst lineNumber = change.lineNumber;\n\t\t\t\tif (this._widgetState.startLineNumbers.includes(lineNumber)) {\n\t\t\t\t\tthis._renderStickyScroll(lineNumber);\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\t\tthis._register(this._editor.onDidChangeConfiguration(e => {\n\t\t\tthis._readConfigurationChange(e);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.CONTEXT_MENU, async (event: MouseEvent) => {\n\t\t\tthis._onContextMenu(dom.getWindow(stickyScrollDomNode), event);\n\t\t}));\n\t\tthis._stickyScrollFocusedContextKey = EditorContextKeys.stickyScrollFocused.bindTo(this._contextKeyService);\n\t\tthis._stickyScrollVisibleContextKey = EditorContextKeys.stickyScrollVisible.bindTo(this._contextKeyService);\n\t\tconst focusTracker = this._register(dom.trackFocus(stickyScrollDomNode));\n\t\tthis._register(focusTracker.onDidBlur(_ => {\n\t\t\t// Suppose that the blurring is caused by scrolling, then keep the focus on the sticky scroll\n\t\t\t// This is determined by the fact that the height of the widget has become zero and there has been no position revealing\n\t\t\tif (this._positionRevealed === false && stickyScrollDomNode.clientHeight === 0) {\n\t\t\t\tthis._focusedStickyElementIndex = -1;\n\t\t\t\tthis.focus();\n\n\t\t\t}\n\t\t\t// In all other casees, dispose the focus on the sticky scroll\n\t\t\telse {\n\t\t\t\tthis._disposeFocusStickyScrollStore();\n\t\t\t}\n\t\t}));\n\t\tthis._register(focusTracker.onDidFocus(_ => {\n\t\t\tthis.focus();\n\t\t}));\n\t\tthis._registerMouseListeners();\n\t\t// Suppose that mouse down on the sticky scroll, then do not focus on the sticky scroll because this will be followed by the revealing of a position\n\t\tthis._register(dom.addDisposableListener(stickyScrollDomNode, dom.EventType.MOUSE_DOWN, (e) => {\n\t\t\tthis._onMouseDown = true;\n\t\t}));\n\t\tthis._register(this._stickyScrollWidget.onDidChangeStickyScrollHeight((e) => {\n\t\t\tthis._onDidChangeStickyScrollHeight.fire(e);\n\t\t}));\n\t\tthis._onDidResize();\n\t\tthis._readConfiguration();\n\t}\n\n\tget stickyScrollWidgetHeight(): number {\n\t\treturn this._stickyScrollWidget.height;\n\t}\n\n\tpublic static get(editor: ICodeEditor): IStickyScrollController | null {\n\t\treturn editor.getContribution<StickyScrollController>(StickyScrollController.ID);\n\t}\n\n\tprivate _disposeFocusStickyScrollStore() {\n\t\tthis._stickyScrollFocusedContextKey.set(false);\n\t\tthis._focusDisposableStore?.dispose();\n\t\tthis._focused = false;\n\t\tthis._positionRevealed = false;\n\t\tthis._onMouseDown = false;\n\t}\n\n\tpublic isFocused(): boolean {\n\t\treturn this._focused;\n\t}\n\n\tpublic focus(): void {\n\t\t// If the mouse is down, do not focus on the sticky scroll\n\t\tif (this._onMouseDown) {\n\t\t\tthis._onMouseDown = false;\n\t\t\tthis._editor.focus();\n\t\t\treturn;\n\t\t}\n\t\tconst focusState = this._stickyScrollFocusedContextKey.get();\n\t\tif (focusState === true) {\n\t\t\treturn;\n\t\t}\n\t\tthis._focused = true;\n\t\tthis._focusDisposableStore = new DisposableStore();\n\t\tthis._stickyScrollFocusedContextKey.set(true);\n\t\tthis._focusedStickyElementIndex = this._stickyScrollWidget.lineNumbers.length - 1;\n\t\tthis._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n\t}\n\n\tpublic focusNext(): void {\n\t\tif (this._focusedStickyElementIndex < this._stickyScrollWidget.lineNumberCount - 1) {\n\t\t\tthis._focusNav(true);\n\t\t}\n\t}\n\n\tpublic focusPrevious(): void {\n\t\tif (this._focusedStickyElementIndex > 0) {\n\t\t\tthis._focusNav(false);\n\t\t}\n\t}\n\n\tpublic selectEditor(): void {\n\t\tthis._editor.focus();\n\t}\n\n\t// True is next, false is previous\n\tprivate _focusNav(direction: boolean): void {\n\t\tthis._focusedStickyElementIndex = direction ? this._focusedStickyElementIndex + 1 : this._focusedStickyElementIndex - 1;\n\t\tthis._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n\t}\n\n\tpublic goToFocused(): void {\n\t\tconst lineNumbers = this._stickyScrollWidget.lineNumbers;\n\t\tthis._disposeFocusStickyScrollStore();\n\t\tthis._revealPosition({ lineNumber: lineNumbers[this._focusedStickyElementIndex], column: 1 });\n\t}\n\n\tprivate _revealPosition(position: IPosition): void {\n\t\tthis._reveaInEditor(position, () => this._editor.revealPosition(position));\n\t}\n\n\tprivate _revealLineInCenterIfOutsideViewport(position: IPosition): void {\n\t\tthis._reveaInEditor(position, () => this._editor.revealLineInCenterIfOutsideViewport(position.lineNumber, ScrollType.Smooth));\n\t}\n\n\tprivate _reveaInEditor(position: IPosition, revealFunction: () => void): void {\n\t\tif (this._focused) {\n\t\t\tthis._disposeFocusStickyScrollStore();\n\t\t}\n\t\tthis._positionRevealed = true;\n\t\trevealFunction();\n\t\tthis._editor.setSelection(Range.fromPositions(position));\n\t\tthis._editor.focus();\n\t}\n\n\tprivate _registerMouseListeners(): void {\n\n\t\tconst sessionStore = this._register(new DisposableStore());\n\t\tconst gesture = this._register(new ClickLinkGesture(this._editor, {\n\t\t\textractLineNumberFromMouseEvent: (e) => {\n\t\t\t\tconst position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n\t\t\t\treturn position ? position.lineNumber : 0;\n\t\t\t}\n\t\t}));\n\n\t\tconst getMouseEventTarget = (mouseEvent: ClickLinkMouseEvent): { range: Range; textElement: HTMLElement } | null => {\n\t\t\tif (!this._editor.hasModel()) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tif (mouseEvent.target.type !== MouseTargetType.OVERLAY_WIDGET || mouseEvent.target.detail !== this._stickyScrollWidget.getId()) {\n\t\t\t\t// not hovering over our widget\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst mouseTargetElement = mouseEvent.target.element;\n\t\t\tif (!mouseTargetElement || mouseTargetElement.innerText !== mouseTargetElement.innerHTML) {\n\t\t\t\t// not on a span element rendering text\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst position = this._stickyScrollWidget.getEditorPositionFromNode(mouseTargetElement);\n\t\t\tif (!position) {\n\t\t\t\t// not hovering a sticky scroll line\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\trange: new Range(position.lineNumber, position.column, position.lineNumber, position.column + mouseTargetElement.innerText.length),\n\t\t\t\ttextElement: mouseTargetElement\n\t\t\t};\n\t\t};\n\n\t\tconst stickyScrollWidgetDomNode = this._stickyScrollWidget.getDomNode();\n\t\tthis._register(dom.addStandardDisposableListener(stickyScrollWidgetDomNode, dom.EventType.CLICK, (mouseEvent: IMouseEvent) => {\n\t\t\tif (mouseEvent.ctrlKey || mouseEvent.altKey || mouseEvent.metaKey) {\n\t\t\t\t// modifier pressed\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!mouseEvent.leftButton) {\n\t\t\t\t// not left click\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (mouseEvent.shiftKey) {\n\t\t\t\t// shift click\n\t\t\t\tconst lineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(mouseEvent.target);\n\t\t\t\tif (lineIndex === null) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconst position = new Position(this._endLineNumbers[lineIndex], 1);\n\t\t\t\tthis._revealLineInCenterIfOutsideViewport(position);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst isInFoldingIconDomNode = this._stickyScrollWidget.isInFoldingIconDomNode(mouseEvent.target);\n\t\t\tif (isInFoldingIconDomNode) {\n\t\t\t\t// clicked on folding icon\n\t\t\t\tconst lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n\t\t\t\tthis._toggleFoldingRegionForLine(lineNumber);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst isInStickyLine = this._stickyScrollWidget.isInStickyLine(mouseEvent.target);\n\t\t\tif (!isInStickyLine) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// normal click\n\t\t\tlet position = this._stickyScrollWidget.getEditorPositionFromNode(mouseEvent.target);\n\t\t\tif (!position) {\n\t\t\t\tconst lineNumber = this._stickyScrollWidget.getLineNumberFromChildDomNode(mouseEvent.target);\n\t\t\t\tif (lineNumber === null) {\n\t\t\t\t\t// not hovering a sticky scroll line\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tposition = new Position(lineNumber, 1);\n\t\t\t}\n\t\t\tthis._revealPosition(position);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(mainWindow, dom.EventType.MOUSE_MOVE, mouseEvent => {\n\t\t\tthis._mouseTarget = mouseEvent.target;\n\t\t\tthis._onMouseMoveOrKeyDown(mouseEvent);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(mainWindow, dom.EventType.KEY_DOWN, mouseEvent => {\n\t\t\tthis._onMouseMoveOrKeyDown(mouseEvent);\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(mainWindow, dom.EventType.KEY_UP, () => {\n\t\t\tif (this._showEndForLine !== undefined) {\n\t\t\t\tthis._showEndForLine = undefined;\n\t\t\t\tthis._renderStickyScroll();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(gesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, _keyboardEvent]) => {\n\t\t\tconst mouseTarget = getMouseEventTarget(mouseEvent);\n\t\t\tif (!mouseTarget || !mouseEvent.hasTriggerModifier || !this._editor.hasModel()) {\n\t\t\t\tsessionStore.clear();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { range, textElement } = mouseTarget;\n\n\t\t\tif (!range.equalsRange(this._stickyRangeProjectedOnEditor)) {\n\t\t\t\tthis._stickyRangeProjectedOnEditor = range;\n\t\t\t\tsessionStore.clear();\n\t\t\t} else if (textElement.style.textDecoration === 'underline') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst cancellationToken = new CancellationTokenSource();\n\t\t\tsessionStore.add(toDisposable(() => cancellationToken.dispose(true)));\n\n\t\t\tlet currentHTMLChild: HTMLElement;\n\n\t\t\tgetDefinitionsAtPosition(this._languageFeaturesService.definitionProvider, this._editor.getModel(), new Position(range.startLineNumber, range.startColumn + 1), false, cancellationToken.token).then((candidateDefinitions => {\n\t\t\t\tif (cancellationToken.token.isCancellationRequested) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (candidateDefinitions.length !== 0) {\n\t\t\t\t\tthis._candidateDefinitionsLength = candidateDefinitions.length;\n\t\t\t\t\tconst childHTML: HTMLElement = textElement;\n\t\t\t\t\tif (currentHTMLChild !== childHTML) {\n\t\t\t\t\t\tsessionStore.clear();\n\t\t\t\t\t\tcurrentHTMLChild = childHTML;\n\t\t\t\t\t\tcurrentHTMLChild.style.textDecoration = 'underline';\n\t\t\t\t\t\tsessionStore.add(toDisposable(() => {\n\t\t\t\t\t\t\tcurrentHTMLChild.style.textDecoration = 'none';\n\t\t\t\t\t\t}));\n\t\t\t\t\t} else if (!currentHTMLChild) {\n\t\t\t\t\t\tcurrentHTMLChild = childHTML;\n\t\t\t\t\t\tcurrentHTMLChild.style.textDecoration = 'underline';\n\t\t\t\t\t\tsessionStore.add(toDisposable(() => {\n\t\t\t\t\t\t\tcurrentHTMLChild.style.textDecoration = 'none';\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tsessionStore.clear();\n\t\t\t\t}\n\t\t\t}));\n\t\t}));\n\t\tthis._register(gesture.onCancel(() => {\n\t\t\tsessionStore.clear();\n\t\t}));\n\t\tthis._register(gesture.onExecute(async e => {\n\t\t\tif (e.target.type !== MouseTargetType.OVERLAY_WIDGET || e.target.detail !== this._stickyScrollWidget.getId()) {\n\t\t\t\t// not hovering over our widget\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst position = this._stickyScrollWidget.getEditorPositionFromNode(e.target.element);\n\t\t\tif (!position) {\n\t\t\t\t// not hovering a sticky scroll line\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!this._editor.hasModel() || !this._stickyRangeProjectedOnEditor) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._candidateDefinitionsLength > 1) {\n\t\t\t\tif (this._focused) {\n\t\t\t\t\tthis._disposeFocusStickyScrollStore();\n\t\t\t\t}\n\t\t\t\tthis._revealPosition({ lineNumber: position.lineNumber, column: 1 });\n\t\t\t}\n\t\t\tthis._instaService.invokeFunction(goToDefinitionWithLocation, e, this._editor as IActiveCodeEditor, { uri: this._editor.getModel().uri, range: this._stickyRangeProjectedOnEditor });\n\t\t}));\n\t}\n\n\tprivate _onContextMenu(targetWindow: Window, e: MouseEvent) {\n\t\tconst event = new StandardMouseEvent(targetWindow, e);\n\n\t\tthis._contextMenuService.showContextMenu({\n\t\t\tmenuId: MenuId.StickyScrollContext,\n\t\t\tgetAnchor: () => event,\n\t\t});\n\t}\n\n\tprivate _onMouseMoveOrKeyDown(mouseEvent: KeyboardEvent | MouseEvent): void {\n\t\tif (!mouseEvent.shiftKey) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this._mouseTarget || !dom.isHTMLElement(this._mouseTarget)) {\n\t\t\treturn;\n\t\t}\n\t\tconst currentEndForLineIndex = this._stickyScrollWidget.getLineIndexFromChildDomNode(this._mouseTarget);\n\t\tif (currentEndForLineIndex === null || this._showEndForLine === currentEndForLineIndex) {\n\t\t\treturn;\n\t\t}\n\t\tthis._showEndForLine = currentEndForLineIndex;\n\t\tthis._renderStickyScroll();\n\t}\n\n\tprivate _toggleFoldingRegionForLine(line: number | null) {\n\t\tif (!this._foldingModel || line === null) {\n\t\t\treturn;\n\t\t}\n\t\tconst stickyLine = this._stickyScrollWidget.getRenderedStickyLine(line);\n\t\tconst foldingIcon = stickyLine?.foldingIcon;\n\t\tif (!foldingIcon) {\n\t\t\treturn;\n\t\t}\n\t\ttoggleCollapseState(this._foldingModel, 1, [line]);\n\t\tfoldingIcon.isCollapsed = !foldingIcon.isCollapsed;\n\t\tconst scrollTop = (foldingIcon.isCollapsed ?\n\t\t\tthis._editor.getTopForLineNumber(foldingIcon.foldingEndLine)\n\t\t\t: this._editor.getTopForLineNumber(foldingIcon.foldingStartLine))\n\t\t\t- this._editor.getOption(EditorOption.lineHeight) * stickyLine.index + 1;\n\t\tthis._editor.setScrollTop(scrollTop);\n\t\tthis._renderStickyScroll(line);\n\t}\n\n\tprivate _readConfiguration() {\n\t\tconst options = this._editor.getOption(EditorOption.stickyScroll);\n\t\tif (options.enabled === false) {\n\t\t\tthis._editor.removeOverlayWidget(this._stickyScrollWidget);\n\t\t\tthis._resetState();\n\t\t\tthis._sessionStore.clear();\n\t\t\tthis._enabled = false;\n\t\t\treturn;\n\t\t} else if (options.enabled && !this._enabled) {\n\t\t\t// When sticky scroll was just enabled, add the listeners on the sticky scroll\n\t\t\tthis._editor.addOverlayWidget(this._stickyScrollWidget);\n\t\t\tthis._sessionStore.add(this._editor.onDidScrollChange((e) => {\n\t\t\t\tif (e.scrollTopChanged) {\n\t\t\t\t\tthis._showEndForLine = undefined;\n\t\t\t\t\tthis._renderStickyScroll();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis._sessionStore.add(this._editor.onDidLayoutChange(() => this._onDidResize()));\n\t\t\tthis._sessionStore.add(this._editor.onDidChangeModelTokens((e) => this._onTokensChange(e)));\n\t\t\tthis._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(() => {\n\t\t\t\tthis._showEndForLine = undefined;\n\t\t\t\tthis._renderStickyScroll();\n\t\t\t}));\n\t\t\tthis._enabled = true;\n\t\t}\n\n\t\tconst lineNumberOption = this._editor.getOption(EditorOption.lineNumbers);\n\t\tif (lineNumberOption.renderType === RenderLineNumbersType.Relative) {\n\t\t\tthis._sessionStore.add(this._editor.onDidChangeCursorPosition(() => {\n\t\t\t\tthis._showEndForLine = undefined;\n\t\t\t\tthis._renderStickyScroll(0);\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate _readConfigurationChange(event: ConfigurationChangedEvent) {\n\t\tif (\n\t\t\tevent.hasChanged(EditorOption.stickyScroll)\n\t\t\t|| event.hasChanged(EditorOption.minimap)\n\t\t\t|| event.hasChanged(EditorOption.lineHeight)\n\t\t\t|| event.hasChanged(EditorOption.showFoldingControls)\n\t\t\t|| event.hasChanged(EditorOption.lineNumbers)\n\t\t) {\n\t\t\tthis._readConfiguration();\n\t\t}\n\n\t\tif (event.hasChanged(EditorOption.lineNumbers) || event.hasChanged(EditorOption.folding) || event.hasChanged(EditorOption.showFoldingControls)) {\n\t\t\tthis._renderStickyScroll(0);\n\t\t}\n\t}\n\n\tprivate _needsUpdate(event: IModelTokensChangedEvent) {\n\t\tconst stickyLineNumbers = this._stickyScrollWidget.getCurrentLines();\n\t\tfor (const stickyLineNumber of stickyLineNumbers) {\n\t\t\tfor (const range of event.ranges) {\n\t\t\t\tif (stickyLineNumber >= range.fromLineNumber && stickyLineNumber <= range.toLineNumber) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _onTokensChange(event: IModelTokensChangedEvent) {\n\t\tif (this._needsUpdate(event)) {\n\t\t\t// Rebuilding the whole widget from line 0\n\t\t\tthis._renderStickyScroll(0);\n\t\t}\n\t}\n\n\tprivate _onDidResize() {\n\t\tconst layoutInfo = this._editor.getLayoutInfo();\n\t\t// Make sure sticky scroll doesn't take up more than 25% of the editor\n\t\tconst theoreticalLines = layoutInfo.height / this._editor.getOption(EditorOption.lineHeight);\n\t\tthis._maxStickyLines = Math.round(theoreticalLines * .25);\n\t\tthis._renderStickyScroll(0);\n\t}\n\n\tprivate async _renderStickyScroll(rebuildFromLine?: number): Promise<void> {\n\t\tconst model = this._editor.getModel();\n\t\tif (!model || model.isTooLargeForTokenization()) {\n\t\t\tthis._resetState();\n\t\t\treturn;\n\t\t}\n\t\tconst nextRebuildFromLine = this._updateAndGetMinRebuildFromLine(rebuildFromLine);\n\t\tconst stickyWidgetVersion = this._stickyLineCandidateProvider.getVersionId();\n\t\tconst shouldUpdateState = stickyWidgetVersion === undefined || stickyWidgetVersion === model.getVersionId();\n\t\tif (shouldUpdateState) {\n\t\t\tif (!this._focused) {\n\t\t\t\tawait this._updateState(nextRebuildFromLine);\n\t\t\t} else {\n\t\t\t\t// Suppose that previously the sticky scroll widget had height 0, then if there are visible lines, set the last line as focused\n\t\t\t\tif (this._focusedStickyElementIndex === -1) {\n\t\t\t\t\tawait this._updateState(nextRebuildFromLine);\n\t\t\t\t\tthis._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n\t\t\t\t\tif (this._focusedStickyElementIndex !== -1) {\n\t\t\t\t\t\tthis._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst focusedStickyElementLineNumber = this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];\n\t\t\t\t\tawait this._updateState(nextRebuildFromLine);\n\t\t\t\t\t// Suppose that after setting the state, there are no sticky lines, set the focused index to -1\n\t\t\t\t\tif (this._stickyScrollWidget.lineNumberCount === 0) {\n\t\t\t\t\t\tthis._focusedStickyElementIndex = -1;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst previousFocusedLineNumberExists = this._stickyScrollWidget.lineNumbers.includes(focusedStickyElementLineNumber);\n\n\t\t\t\t\t\t// If the line number is still there, do not change anything\n\t\t\t\t\t\t// If the line number is not there, set the new focused line to be the last line\n\t\t\t\t\t\tif (!previousFocusedLineNumberExists) {\n\t\t\t\t\t\t\tthis._focusedStickyElementIndex = this._stickyScrollWidget.lineNumberCount - 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _updateAndGetMinRebuildFromLine(rebuildFromLine: number | undefined): number | undefined {\n\t\tif (rebuildFromLine !== undefined) {\n\t\t\tconst minRebuildFromLineOrInfinity = this._minRebuildFromLine !== undefined ? this._minRebuildFromLine : Infinity;\n\t\t\tthis._minRebuildFromLine = Math.min(rebuildFromLine, minRebuildFromLineOrInfinity);\n\t\t}\n\t\treturn this._minRebuildFromLine;\n\t}\n\n\tprivate async _updateState(rebuildFromLine?: number): Promise<void> {\n\t\tthis._minRebuildFromLine = undefined;\n\t\tthis._foldingModel = await FoldingController.get(this._editor)?.getFoldingModel() ?? undefined;\n\t\tthis._widgetState = this.findScrollWidgetState();\n\t\tconst stickyWidgetHasLines = this._widgetState.startLineNumbers.length > 0;\n\t\tthis._stickyScrollVisibleContextKey.set(stickyWidgetHasLines);\n\t\tthis._stickyScrollWidget.setState(this._widgetState, this._foldingModel, rebuildFromLine);\n\t}\n\n\tprivate async _resetState(): Promise<void> {\n\t\tthis._minRebuildFromLine = undefined;\n\t\tthis._foldingModel = undefined;\n\t\tthis._widgetState = StickyScrollWidgetState.Empty;\n\t\tthis._stickyScrollVisibleContextKey.set(false);\n\t\tthis._stickyScrollWidget.setState(undefined, undefined);\n\t}\n\n\tfindScrollWidgetState(): StickyScrollWidgetState {\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn StickyScrollWidgetState.Empty;\n\t\t}\n\t\tconst textModel = this._editor.getModel();\n\t\tconst maxNumberStickyLines = Math.min(this._maxStickyLines, this._editor.getOption(EditorOption.stickyScroll).maxLineCount);\n\t\tconst scrollTop: number = this._editor.getScrollTop();\n\t\tlet lastLineRelativePosition: number = 0;\n\t\tconst startLineNumbers: number[] = [];\n\t\tconst endLineNumbers: number[] = [];\n\t\tconst arrayVisibleRanges = this._editor.getVisibleRanges();\n\t\tif (arrayVisibleRanges.length !== 0) {\n\t\t\tconst fullVisibleRange = new StickyRange(arrayVisibleRanges[0].startLineNumber, arrayVisibleRanges[arrayVisibleRanges.length - 1].endLineNumber);\n\t\t\tconst candidateRanges = this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(fullVisibleRange);\n\t\t\tfor (const range of candidateRanges) {\n\t\t\t\tconst start = range.startLineNumber;\n\t\t\t\tconst end = range.endLineNumber;\n\t\t\t\tconst isValidRange = textModel.isValidRange({ startLineNumber: start, endLineNumber: end, startColumn: 1, endColumn: 1 });\n\t\t\t\tif (isValidRange && end - start > 0) {\n\t\t\t\t\tconst topOfElement = range.top;\n\t\t\t\t\tconst bottomOfElement = topOfElement + range.height;\n\t\t\t\t\tconst topOfBeginningLine = this._editor.getTopForLineNumber(start) - scrollTop;\n\t\t\t\t\tconst bottomOfEndLine = this._editor.getBottomForLineNumber(end) - scrollTop;\n\t\t\t\t\tif (topOfElement > topOfBeginningLine && topOfElement <= bottomOfEndLine) {\n\t\t\t\t\t\tstartLineNumbers.push(start);\n\t\t\t\t\t\tendLineNumbers.push(end + 1);\n\t\t\t\t\t\tif (bottomOfElement > bottomOfEndLine) {\n\t\t\t\t\t\t\tlastLineRelativePosition = bottomOfEndLine - bottomOfElement;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (startLineNumbers.length === maxNumberStickyLines) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._endLineNumbers = endLineNumbers;\n\t\treturn new StickyScrollWidgetState(startLineNumbers, endLineNumbers, lastLineRelativePosition, this._showEndForLine);\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t\tthis._sessionStore.dispose();\n\t}\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1713, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollActions.js","sourceRoot":"file:///mnt/vss/_work/1/s/dependencies/vscode/out-editor-src","sources":["file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/vs/editor/contrib/stickyScroll/browser/stickyScrollActions.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { KeyCode } from '../../../../base/common/keyCodes.js';\nimport { EditorAction2, ServicesAccessor } from '../../../browser/editorExtensions.js';\nimport { localize, localize2 } from '../../../../nls.js';\nimport { Categories } from '../../../../platform/action/common/actionCommonCategories.js';\nimport { MenuId } from '../../../../platform/actions/common/actions.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { KeybindingWeight } from '../../../../platform/keybinding/common/keybindingsRegistry.js';\nimport { ContextKeyExpr } from '../../../../platform/contextkey/common/contextkey.js';\nimport { EditorContextKeys } from '../../../common/editorContextKeys.js';\nimport { ICodeEditor } from '../../../browser/editorBrowser.js';\nimport { StickyScrollController } from './stickyScrollController.js';\n\nexport class ToggleStickyScroll extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.toggleStickyScroll',\n\t\t\ttitle: {\n\t\t\t\t...localize2('toggleEditorStickyScroll', \"Toggle Editor Sticky Scroll\"),\n\t\t\t\tmnemonicTitle: localize({ key: 'mitoggleStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Editor Sticky Scroll\"),\n\t\t\t},\n\t\t\tmetadata: {\n\t\t\t\tdescription: localize2('toggleEditorStickyScroll.description', \"Toggle/enable the editor sticky scroll which shows the nested scopes at the top of the viewport\"),\n\t\t\t},\n\t\t\tcategory: Categories.View,\n\t\t\ttoggled: {\n\t\t\t\tcondition: ContextKeyExpr.equals('config.editor.stickyScroll.enabled', true),\n\t\t\t\ttitle: localize('stickyScroll', \"Sticky Scroll\"),\n\t\t\t\tmnemonicTitle: localize({ key: 'miStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Sticky Scroll\"),\n\t\t\t},\n\t\t\tmenu: [\n\t\t\t\t{ id: MenuId.CommandPalette },\n\t\t\t\t{ id: MenuId.MenubarAppearanceMenu, group: '4_editor', order: 3 },\n\t\t\t\t{ id: MenuId.StickyScrollContext }\n\t\t\t]\n\t\t});\n\t}\n\n\tasync runEditorCommand(accessor: ServicesAccessor, editor: ICodeEditor): Promise<void> {\n\t\tconst configurationService = accessor.get(IConfigurationService);\n\t\tconst newValue = !configurationService.getValue('editor.stickyScroll.enabled');\n\t\tconst isFocused = StickyScrollController.get(editor)?.isFocused();\n\t\tconfigurationService.updateValue('editor.stickyScroll.enabled', newValue);\n\t\tif (isFocused) {\n\t\t\teditor.focus();\n\t\t}\n\t}\n}\n\nconst weight = KeybindingWeight.EditorContrib;\n\nexport class FocusStickyScroll extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.focusStickyScroll',\n\t\t\ttitle: {\n\t\t\t\t...localize2('focusStickyScroll', \"Focus Editor Sticky Scroll\"),\n\t\t\t\tmnemonicTitle: localize({ key: 'mifocusEditorStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Focus Editor Sticky Scroll\"),\n\t\t\t},\n\t\t\tprecondition: ContextKeyExpr.and(ContextKeyExpr.has('config.editor.stickyScroll.enabled'), EditorContextKeys.stickyScrollVisible),\n\t\t\tmenu: [\n\t\t\t\t{ id: MenuId.CommandPalette },\n\t\t\t]\n\t\t});\n\t}\n\n\trunEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor) {\n\t\tStickyScrollController.get(editor)?.focus();\n\t}\n}\n\nexport class SelectNextStickyScrollLine extends EditorAction2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.selectNextStickyScrollLine',\n\t\t\ttitle: localize2('selectNextStickyScrollLine.title', \"Select the next editor sticky scroll line\"),\n\t\t\tprecondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n\t\t\tkeybinding: {\n\t\t\t\tweight,\n\t\t\t\tprimary: KeyCode.DownArrow\n\t\t\t}\n\t\t});\n\t}\n\n\trunEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor) {\n\t\tStickyScrollController.get(editor)?.focusNext();\n\t}\n}\n\nexport class SelectPreviousStickyScrollLine extends EditorAction2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.selectPreviousStickyScrollLine',\n\t\t\ttitle: localize2('selectPreviousStickyScrollLine.title', \"Select the previous sticky scroll line\"),\n\t\t\tprecondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n\t\t\tkeybinding: {\n\t\t\t\tweight,\n\t\t\t\tprimary: KeyCode.UpArrow\n\t\t\t}\n\t\t});\n\t}\n\n\trunEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor) {\n\t\tStickyScrollController.get(editor)?.focusPrevious();\n\t}\n}\n\nexport class GoToStickyScrollLine extends EditorAction2 {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.goToFocusedStickyScrollLine',\n\t\t\ttitle: localize2('goToFocusedStickyScrollLine.title', \"Go to the focused sticky scroll line\"),\n\t\t\tprecondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n\t\t\tkeybinding: {\n\t\t\t\tweight,\n\t\t\t\tprimary: KeyCode.Enter\n\t\t\t}\n\t\t});\n\t}\n\n\trunEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor) {\n\t\tStickyScrollController.get(editor)?.goToFocused();\n\t}\n}\n\nexport class SelectEditor extends EditorAction2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.selectEditor',\n\t\t\ttitle: localize2('selectEditor.title', \"Select Editor\"),\n\t\t\tprecondition: EditorContextKeys.stickyScrollFocused.isEqualTo(true),\n\t\t\tkeybinding: {\n\t\t\t\tweight,\n\t\t\t\tprimary: KeyCode.Escape\n\t\t\t}\n\t\t});\n\t}\n\n\trunEditorCommand(_accessor: ServicesAccessor, editor: ICodeEditor) {\n\t\tStickyScrollController.get(editor)?.selectEditor();\n\t}\n}\n"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;AAGhG,OAAO,EAAE,aAAa,EAAoB,MAAM,sCAAsC,CAAC;AACvF,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,oBAAoB,CAAC;AACzD,OAAO,EAAE,UAAU,EAAE,MAAM,8DAA8D,CAAC;AAC1F,OAAO,EAAE,MAAM,EAAE,MAAM,gDAAgD,CAAC;AACxE,OAAO,EAAE,qBAAqB,EAAE,MAAM,4DAA4D,CAAC;AAEnG,OAAO,EAAE,cAAc,EAAE,MAAM,sDAAsD,CAAC;AACtF,OAAO,EAAE,iBAAiB,EAAE,MAAM,sCAAsC,CAAC;AAEzE,OAAO,EAAE,sBAAsB,EAAE,MAAM,6BAA6B,CAAC;;;;;;;;;AAE/D,MAAO,kBAAmB,SAAQ,0MAAa;IA0BpD,KAAK,CAAC,gBAAgB,CAAC,QAA0B,EAAE,MAAmB,EAAA;;QACrE,MAAM,oBAAoB,GAAG,QAAQ,CAAC,GAAG,CAAC,iOAAqB,CAAC,CAAC;QACjE,MAAM,QAAQ,GAAG,CAAC,oBAAoB,CAAC,QAAQ,CAAC,6BAA6B,CAAC,CAAC;QAC/E,MAAM,SAAS,sRAAyB,CAAC,GAAG,CAAC,MAAM,CAAC,cAAlC,8EAAoC,SAAS,EAAE,CAAC;QAClE,oBAAoB,CAAC,WAAW,CAAC,6BAA6B,EAAE,QAAQ,CAAC,CAAC;QAC1E,IAAI,SAAS,EAAE,CAAC;YACf,MAAM,CAAC,KAAK,EAAE,CAAC;QAChB,CAAC;IACF,CAAC;IAhCD,aAAA;QACC,KAAK,CAAC;YACL,EAAE,EAAE,kCAAkC;YACtC,KAAK,EAAE;gBACN,OAAG,oLAAS,EAAC,IAA0B,EAAE,6BAA6B,CAAC;gBACvE,aAAa,MAAE,mLAAQ,EAAC,EAAE,EAAiE,CAA9D,CAAgE,CAA9D,sBAAsB,EAAE,MAAqE,CAA9D,AAA+D,EAA7D,CAAC,uBAAuB,CAAC;aACzF;YACD,QAAQ,EAAE;gBACT,WAAW,MAAE,oLAAS,EAAC,IAAsC,EAAE,iGAAiG,CAAC;aACjK;YACD,QAAQ,EAAE,wNAAU,CAAC,IAAI;YACzB,OAAO,EAAE;gBACR,SAAS,EAAE,oNAAc,CAAC,MAAM,CAAC,oCAAoC,EAAE,IAAI,CAAC;gBAC5E,KAAK,MAAE,mLAAQ,EAAC,IAAc,EAAE,eAAe,CAAC;gBAChD,aAAa,EAAE,uLAAQ,EAAC,EAAE,EAA2D,CAAxD,CAA0D,CAAxD,gBAAgB,AAAyD,CAAC,CAAxD,OAAO,EAAE,CAAC,uBAAuB,CAAC;aACnF;YACD,IAAI,EAAE;gBACL;oBAAE,EAAE,EAAE,sMAAM,CAAC,cAAc;gBAAA,CAAE;gBAC7B;oBAAE,EAAE,EAAE,sMAAM,CAAC,qBAAqB;oBAAE,KAAK,EAAE,UAAU;oBAAE,KAAK,EAAE,CAAC;gBAAA,CAAE;gBACjE;oBAAE,EAAE,EAAE,sMAAM,CAAC,mBAAmB;gBAAA,CAAE;aAClC;SACD,CAAC,CAAC;IACJ,CAAC;CAWD;AAED,MAAM,MAAM,GAAA,IAAA,kCAAA,EAAiC,CAAC;AAExC,MAAO,iBAAkB,SAAQ,0MAAa;IAgBnD,gBAAgB,CAAC,SAA2B,EAAE,MAAmB,EAAA;;2RAC1C,CAAC,GAAG,CAAC,MAAM,CAAC,gEAAlC,4BAAoC,KAAK,EAAE,CAAC;IAC7C,CAAC;IAhBD,aAAA;QACC,KAAK,CAAC;YACL,EAAE,EAAE,iCAAiC;YACrC,KAAK,EAAE;gBACN,OAAG,oLAAS,EAAC,IAAmB,EAAE,4BAA4B,CAAC;gBAC/D,aAAa,MAAE,mLAAQ,EAAC,EAAE,EAAsE,CAAnE,CAAqE,CAAnE,2BAA2B,EAAE,AAAoE,CAAC,MAA9D,EAAE,CAAC,uBAAuB,CAAC;aAC9F;YACD,YAAY,EAAE,oNAAc,CAAC,GAAG,CAAC,oNAAc,CAAC,GAAG,CAAC,oCAAoC,CAAC,EAAE,8MAAiB,CAAC,mBAAmB,CAAC;YACjI,IAAI,EAAE;gBACL;oBAAE,EAAE,EAAE,sMAAM,CAAC,cAAc;gBAAA,CAAE;aAC7B;SACD,CAAC,CAAC;IACJ,CAAC;CAKD;AAEK,MAAO,0BAA2B,SAAQ,0MAAa;IAa5D,gBAAgB,CAAC,SAA2B,EAAE,MAAmB,EAAA;;2RAC1C,CAAC,GAAG,CAAC,MAAM,CAAC,gEAAlC,4BAAoC,SAAS,EAAE,CAAC;IACjD,CAAC;IAdD,aAAA;QACC,KAAK,CAAC;YACL,EAAE,EAAE,0CAA0C;YAC9C,KAAK,MAAE,oLAAS,EAAC,IAAkC,EAAE,2CAA2C,CAAC;YACjG,YAAY,EAAE,8MAAiB,CAAC,mBAAmB,CAAC,SAAS,CAAC,IAAI,CAAC;YACnE,UAAU,EAAE;gBACX,MAAM;gBACN,OAAO,EAAA,GAAA,qBAAA,EAAmB;aAC1B;SACD,CAAC,CAAC;IACJ,CAAC;CAKD;AAEK,MAAO,8BAA+B,SAAQ,0MAAa;IAahE,gBAAgB,CAAC,SAA2B,EAAE,MAAmB,EAAA;;uCAChE,oPAAsB,CAAC,GAAG,CAAC,MAAM,CAAC,4FAAE,aAAa,EAAE,CAAC;IACrD,CAAC;IAdD,aAAA;QACC,KAAK,CAAC;YACL,EAAE,EAAE,8CAA8C;YAClD,KAAK,MAAE,oLAAS,EAAC,IAAsC,EAAE,wCAAwC,CAAC;YAClG,YAAY,EAAE,8MAAiB,CAAC,mBAAmB,CAAC,SAAS,CAAC,IAAI,CAAC;YACnE,UAAU,EAAE;gBACX,MAAM;gBACN,OAAO,EAAA,GAAA,mBAAA,EAAiB;aACxB;SACD,CAAC,CAAC;IACJ,CAAC;CAKD;AAEK,MAAO,oBAAqB,SAAQ,0MAAa;IAatD,gBAAgB,CAAC,SAA2B,EAAE,MAAmB,EAAA;;2RAC1C,CAAC,GAAG,CAAC,MAAM,CAAC,cAAlC,8EAAoC,WAAW,EAAE,CAAC;IACnD,CAAC;IAdD,aAAA;QACC,KAAK,CAAC;YACL,EAAE,EAAE,2CAA2C;YAC/C,KAAK,MAAE,oLAAS,EAAC,IAAmC,EAAE,sCAAsC,CAAC;YAC7F,YAAY,EAAE,8MAAiB,CAAC,mBAAmB,CAAC,SAAS,CAAC,IAAI,CAAC;YACnE,UAAU,EAAE;gBACX,MAAM;gBACN,OAAO,EAAA,EAAA,iBAAA,EAAe;aACtB;SACD,CAAC,CAAC;IACJ,CAAC;CAKD;AAEK,MAAO,YAAa,SAAQ,0MAAa;IAc9C,gBAAgB,CAAC,SAA2B,EAAE,MAAmB,EAAA;;SAChE,kRAAsB,CAAC,GAAG,CAAC,MAAM,CAAC,4FAAE,YAAY,EAAE,CAAC;IACpD,CAAC;IAdD,aAAA;QACC,KAAK,CAAC;YACL,EAAE,EAAE,4BAA4B;YAChC,KAAK,MAAE,oLAAS,EAAC,IAAoB,EAAE,eAAe,CAAC;YACvD,YAAY,EAAE,8MAAiB,CAAC,mBAAmB,CAAC,SAAS,CAAC,IAAI,CAAC;YACnE,UAAU,EAAE;gBACX,MAAM;gBACN,OAAO,EAAA,EAAA,kBAAA,EAAgB;aACvB;SACD,CAAC,CAAC;IACJ,CAAC;CAKD","debugId":null}},
    {"offset": {"line": 1883, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/stickyScrollContribution.js","sourceRoot":"file:///mnt/vss/_work/1/s/dependencies/vscode/out-editor-src","sources":["file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/file%3A/mnt/vss/_work/1/s/dependencies/vscode/out-editor-src/vs/editor/contrib/stickyScroll/browser/stickyScrollContribution.ts","file:///Users/liza/Desktop/FrontReady/node_modules/monaco-editor/esm/vs/editor/contrib/stickyScroll/browser/vs/editor/contrib/stickyScroll/browser/stickyScrollContribution.ts"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { EditorContributionInstantiation, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ToggleStickyScroll, FocusStickyScroll, SelectEditor, SelectPreviousStickyScrollLine, SelectNextStickyScrollLine, GoToStickyScrollLine } from './stickyScrollActions.js';\nimport { StickyScrollController } from './stickyScrollController.js';\nimport { registerAction2 } from '../../../../platform/actions/common/actions.js';\n\nregisterEditorContribution(StickyScrollController.ID, StickyScrollController, EditorContributionInstantiation.AfterFirstRender);\nregisterAction2(ToggleStickyScroll);\nregisterAction2(FocusStickyScroll);\nregisterAction2(SelectPreviousStickyScrollLine);\nregisterAction2(SelectNextStickyScrollLine);\nregisterAction2(GoToStickyScrollLine);\nregisterAction2(SelectEditor);\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { EditorContributionInstantiation, registerEditorContribution } from '../../../browser/editorExtensions.js';\nimport { ToggleStickyScroll, FocusStickyScroll, SelectEditor, SelectPreviousStickyScrollLine, SelectNextStickyScrollLine, GoToStickyScrollLine } from './stickyScrollActions.js';\nimport { StickyScrollController } from './stickyScrollController.js';\nimport { registerAction2 } from '../../../../platform/actions/common/actions.js';\n\nregisterEditorContribution(StickyScrollController.ID, StickyScrollController, EditorContributionInstantiation.AfterFirstRender);\nregisterAction2(ToggleStickyScroll);\nregisterAction2(FocusStickyScroll);\nregisterAction2(SelectPreviousStickyScrollLine);\nregisterAction2(SelectNextStickyScrollLine);\nregisterAction2(GoToStickyScrollLine);\nregisterAction2(SelectEditor);\n"],"names":[],"mappings":"AAAA;;;gGAGgG;AAEhG,OAAO,EAAmC,0BAA0B,EAAE,MAAM,sCAAsC,CAAC;AACnH,OAAO,EAAE,kBAAkB,EAAE,iBAAiB,EAAE,YAAY,EAAE,8BAA8B,EAAE,0BAA0B,EAAE,oBAAoB,EAAE,MAAM,0BAA0B,CAAC;AACjL,OAAO,EAAE,sBAAsB,EAAE,MAAM,6BAA6B,CAAC;AACrE,OAAO,EAAE,eAAe,EAAE,MAAM,gDAAgD,CAAC;;;;;IAEjF,uNAA0B,EAAC,oPAAsB,CAAC,EAAE,EAAE,oPAAsB,EAAA,EAAA,oDAAA,GAAmD,CAAC;IAChI,+MAAe,EAAC,6OAAkB,CAAC,CAAC;IACpC,+MAAe,EAAC,4OAAiB,CAAC,CAAC;IACnC,+MAAe,EAAC,yPAA8B,CAAC,CAAC;IAChD,+MAAe,EAAC,qPAA0B,CAAC,CAAC;IAC5C,+MAAe,EAAC,+OAAoB,CAAC,CAAC;IACtC,+MAAe,EAAC,uOAAY,CAAC,CAAC","debugId":null}}]
}